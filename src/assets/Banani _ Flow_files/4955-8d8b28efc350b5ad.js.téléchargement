try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="86e71483-381b-487a-810f-02403f8f956f",e._sentryDebugIdIdentifier="sentry-dbid-86e71483-381b-487a-810f-02403f8f956f")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4955],{1237:(e,t,n)=>{n.d(t,{A:()=>s});var r,o,i,l=n(12115);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let s=function(e){return l.createElement("svg",a({width:25,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=l.createElement("path",{d:"M12.5 4V9M12.5 4H10C8.61929 4 7.5 5.11929 7.5 6.5V6.5C7.5 7.88071 8.61929 9 10 9H12.5M12.5 4H15C16.3807 4 17.5 5.11929 17.5 6.5V6.5C17.5 7.88071 16.3807 9 15 9H12.5",stroke:"currentColor",strokeWidth:2})),o||(o=l.createElement("path",{d:"M12.5 16.5V14H10C8.61929 14 7.5 15.1193 7.5 16.5C7.5 17.8807 8.61929 19 10 19C11.3807 19 12.5 17.8807 12.5 16.5Z",stroke:"currentColor",strokeWidth:2})),i||(i=l.createElement("path",{d:"M12.5 9V14M12.5 9H10C8.61929 9 7.5 10.1193 7.5 11.5V11.5C7.5 12.8807 8.61929 14 10 14H12.5M12.5 9H15C16.3807 9 17.5 10.1193 17.5 11.5V11.5C17.5 12.8807 16.3807 14 15 14H12.5",stroke:"currentColor",strokeWidth:2})))}},3183:(e,t,n)=>{n.d(t,{N:()=>r,u:()=>o});let r=100,o=e=>{let t=e.includes("mobile");return{width:t?375:1440,height:t?812:1024,offset:t?475:1540}}},15551:(e,t,n)=>{n.d(t,{M:()=>x,l:()=>w});var r=n(95155),o=n(19749),i=n(12115),l=n(84968),a=n(63879),s=n(38254),c=n(3183),u=n(48842),d=n(70891),m=n(3585),p=n(89086),h=n(27806),f=n(90214),g=n(2032),v=n(88571);let y=(0,i.createContext)(null);function x(){let e=(0,i.useContext)(y);if(!e)throw Error("useScreenCreationContext must be used within ScreenCreationProvider");return e}function w(e){let t,n,x,w,b,E,C,k,j,S=(0,o.c)(34),{flowId:L,children:_}=e,{genType:M}=(0,i.useContext)(v.c).flow,T=(0,l.p)(),{screenToFlowPosition:I,getNode:N}=(0,a.VH)();S[0]!==L?(t={flowId:L},S[0]=L,S[1]=t):t=S[1];let{data:O}=s.i.getFlowScreens.useQuery(t),F=s.i.useUtils(),A=(0,d.Ag)(),H=(0,p.Xr)(m.vb),{fitViewToChat:P}=(0,h.k)(),z=(0,f.d)();S[2]!==A||S[3]!==P||S[4]!==L||S[5]!==H||S[6]!==z?(n=async(e,t,n)=>{u.A.logEvent("[Flow] add new screen click"),(null==n?void 0:n.hiddenMessage)&&H(n.hiddenMessage);let r=(0,g.$)();z(r);let o=A.mutateAsync({flowId:L,screenId:r,x:e,y:t}),i=document.getElementById("input-main");return i&&i.focus(),requestAnimationFrame(()=>{P(r)}),await o,r},S[2]=A,S[3]=P,S[4]=L,S[5]=H,S[6]=z,S[7]=n):n=S[7];let V=n;S[8]!==M||S[9]!==F?(x=async e=>{let[t,n]=await Promise.all([F.recentUserMessages.fetch({screenId:e}),F.getActiveStructure.fetch({screenId:e})]),r=function(e,t){if("web-html-css"===t||"mobile-html-css"===t){var n;return null!=(n=null==e?void 0:e.htmlCss)?n:void 0}if(!(null==e?void 0:e.legacyComponents))return;let r=e.legacyComponents.at(0);return JSON.stringify(null==r?void 0:r.map(e=>({...e,props:{...e.props,iconsSvg:[],images:[]}})))}(n,M),o=null==t?void 0:t.filter(e=>null!==e.text),i=(null==o?void 0:o.length)?"Use these previous user's messages: ".concat(o.map(e=>e.text).join(", "),". "):"";return"".concat(i?"<userPreviousMessages>".concat(i,"</userPreviousMessages>"):"","\n        ").concat(r?" <screenThatNeedsToBeUpdated>".concat(r,"</screenThatNeedsToBeUpdated>"):"")},S[8]=M,S[9]=F,S[10]=x):x=S[10];let D=x;S[11]!==V||S[12]!==M||S[13]!==I?(w=async e=>{let t=I({x:window.innerWidth/2,y:window.innerHeight/2}),{width:n,height:r}=(0,c.u)(M);return V(t.x-n/2,t.y-r/2,e)},S[11]=V,S[12]=M,S[13]=I,S[14]=w):w=S[14];let W=w;S[15]!==V||S[16]!==W||S[17]!==D||S[18]!==M||S[19]!==N||S[20]!==O?(b=async(e,t)=>{let n={hiddenMessage:await D(e)},r=null==O?void 0:O.find(t=>t.id===e);if(r&&"number"==typeof r.x&&"number"==typeof r.y){let{width:e,height:o}=(0,c.u)(M),i=r.x,l=r.y;switch(t){case"left":i=r.x-e-c.N;break;case"right":i=r.x+e+c.N;break;case"bottom":l=r.y+o+c.N}return V(i,l,n)}let o=N(e);if(null==o?void 0:o.position){let{width:e,height:r}=(0,c.u)(M),i=o.position.x,l=o.position.y;switch(t){case"left":i=o.position.x-e-c.N;break;case"right":i=o.position.x+e+c.N;break;case"bottom":l=o.position.y+r+c.N}return V(i,l,n)}return W(n)},S[15]=V,S[16]=W,S[17]=D,S[18]=M,S[19]=N,S[20]=O,S[21]=b):b=S[21];let B=b;S[22]!==T||S[23]!==W||S[24]!==B?(E=async e=>T?B(T,void 0===e?"right":e):W(),S[22]=T,S[23]=W,S[24]=B,S[25]=E):E=S[25];let R=E;return S[26]!==V||S[27]!==W||S[28]!==R||S[29]!==B?(k={createScreen:V,createScreenCentered:W,createScreenContextual:R,createScreenRelativeTo:B},S[26]=V,S[27]=W,S[28]=R,S[29]=B,S[30]=k):k=S[30],C=k,S[31]!==_||S[32]!==C?(j=(0,r.jsx)(y.Provider,{value:C,children:_}),S[31]=_,S[32]=C,S[33]=j):j=S[33],j}},31262:(e,t,n)=>{n.d(t,{H:()=>ej});var r,o,i,l,a,s,c=n(95155),u=n(19749),d=n(63879),m=n(89086),p=n(12115),h=n(52779),f=n(19013),g=n(23838);function v(){return(v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let y=function(e){return p.createElement("svg",v({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=p.createElement("g",{clipPath:"url(#clip0_3356_11541)"},p.createElement("path",{d:"M16 6H12M14 4V8",stroke:"#745EFF",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),p.createElement("path",{d:"M6.67857 11.6786L7 9L7.32143 11.6786L10 12L7.32143 12.3214L7 15L6.67857 12.3214L4 12L6.67857 11.6786Z",fill:"#745EFF",stroke:"#745EFF",strokeWidth:2,strokeLinejoin:"round"}))),o||(o=p.createElement("defs",null,p.createElement("clipPath",{id:"clip0_3356_11541"},p.createElement("rect",{width:20,height:20,fill:"white"})))))};var x=n(96988),w=n(41298),b=n(90214),E=n(70891),C=n(3183);let k=e=>{let t,n,r,o,i,l,a,s,d,m,v,k,j,S,L,_,M,T=(0,u.c)(47),{flowId:I,currentChatId:N,arrId:O,isActiveFrame:F,genType:A}=e,H=(0,p.useRef)(null),P=((0,C.u)(A).width-120)/2,[z,V]=(0,p.useState)(!1),{isOpen:D,onOpen:W,onClose:B}=(0,f.j)(),R=(0,b.d)(),U=(0,E.vM)(I);T[0]!==N||T[1]!==U||T[2]!==B?(t=async()=>{N&&(await U.mutateAsync({screenId:N}),B())},T[0]=N,T[1]=U,T[2]=B,T[3]=t):t=T[3];let X=t;T[4]!==W||T[5]!==F?(n=()=>{let e=e=>{let t=document.activeElement;!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||(null==t?void 0:t.hasAttribute("contenteditable")))&&F&&("Delete"===e.key&&W(),"Backspace"===e.key&&W(),(e.metaKey||e.ctrlKey)&&"Backspace"===e.key&&W())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},r=[F,W],T[4]=W,T[5]=F,T[6]=n,T[7]=r):(n=T[6],r=T[7]),(0,p.useEffect)(n,r),T[8]!==X||T[9]!==D||T[10]!==B?(o=()=>{let e=e=>{let t=document.activeElement;(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||(null==t?void 0:t.hasAttribute("contenteditable")))||"Escape"===e.key)&&D&&("Enter"===e.key&&X(),"Escape"===e.key&&B())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},i=[D,X,B],T[8]=X,T[9]=D,T[10]=B,T[11]=o,T[12]=i):(o=T[11],i=T[12]),(0,p.useEffect)(o,i);let Z=(0,g.T)(N);T[13]!==N||T[14]!==W?(l=()=>{let e=e=>{e.detail.chatId===N&&W()},t=document.getElementById(N);if(t)return t.addEventListener("delete-screen",e),()=>{t.removeEventListener("delete-screen",e)}},a=[N,W],T[13]=N,T[14]=W,T[15]=l,T[16]=a):(l=T[15],a=T[16]),(0,p.useEffect)(l,a),T[17]===Symbol.for("react.memo_cache_sentinel")?(s={height:"calc(28px * var(--inverse-zoom, 1))",position:"relative"},T[17]=s):s=T[17],T[18]!==N||T[19]!==R?(d=()=>R(N),T[18]=N,T[19]=R,T[20]=d):d=T[20],T[21]===Symbol.for("react.memo_cache_sentinel")?(m={transform:"scale(var(--inverse-zoom, 1))",top:0,transformOrigin:"left top",position:"absolute"},T[21]=m):m=T[21];let K=Z&&"text-[var(--ai-thinking)]",G=F&&"text-[var(--primary-hex)]";T[22]!==K||T[23]!==G?(v=(0,h.cn)("relative flex h-[24px] cursor-pointer flex-row items-center gap-[8px] rounded-[24px] text-[12px] font-medium","text-[var(--inactive-text)]",K,G,"group-hover:text-[var(--primary-hex)]"),T[22]=K,T[23]=G,T[24]=v):v=T[24],T[25]!==X||T[26]!==D||T[27]!==B?(k=(0,c.jsx)(w.C,{isOpen:D,onClose:B,onDelete:X,title:"Delete screen",body:"You are about to delete the selected screen. You sure about this?"}),T[25]=X,T[26]=D,T[27]=B,T[28]=k):k=T[28],T[29]!==Z?(j=Z?(0,c.jsx)(y,{}):(0,c.jsx)(c.Fragment,{}),T[29]=Z,T[30]=j):j=T[30];let Y="calc(".concat(P,"px * var(--canvas-zoom, 1))"),$=Z?"var(--ai-thinking)":void 0;return T[31]!==Y||T[32]!==$?(S={maxWidth:Y,color:$},T[31]=Y,T[32]=$,T[33]=S):S=T[33],T[34]!==O||T[35]!==N||T[36]!==z||T[37]!==S?(L=(0,c.jsx)(x.e,{chatId:N,isEditable:z,setIsEditable:V,screenCount:O,style:S}),T[34]=O,T[35]=N,T[36]=z,T[37]=S,T[38]=L):L=T[38],T[39]!==j||T[40]!==L?(_=(0,c.jsxs)("div",{className:"flex flex-row items-center gap-[2px]",children:[j,L]}),T[39]=j,T[40]=L,T[41]=_):_=T[41],T[42]!==v||T[43]!==k||T[44]!==_||T[45]!==d?(M=(0,c.jsx)("div",{style:s,children:(0,c.jsxs)("div",{ref:H,onClick:d,style:m,className:v,children:[k,_]})}),T[42]=v,T[43]=k,T[44]=_,T[45]=d,T[46]=M):M=T[46],M};var j=n(48842),S=n(26593),L=n(88571),_=n(28295),M=n(62311),T=n(36829),I=n(72869),N=n(69172),O=n(55902),F=n(60375),A=n(3585),H=n(84968),P=n(20429),z=n(39605),V=n(61641),D=n(71498),W=n(45898);let B=e=>{let t,n,r=(0,u.c)(6),o=(0,I.P)(e),i=(0,p.useContext)(L.c).flow,l=(0,T.Bq)(i.id,null!=e?e:void 0);r[0]!==l?(t=()=>{if(!l)return"";let{fontFamilyBody:e,...t}=W.Sr.strip().parse(l),n={...t,"--font-family-body":D.l[e].name};return"\n<style>\n:root {\n".concat(Object.entries(n).map(X).join("\n"),"\n}\n</style>")},r[0]=l,r[1]=t):t=r[1];let a=t,s=i.genType.includes("web")?1440:375;return r[2]!==a||r[3]!==(null==o?void 0:o.htmlCss)||r[4]!==s?(n=async()=>{let e=null==o?void 0:o.htmlCss;if(!e)throw Error("structure is not a string");let t=await (0,z.V)(e);return'<div style="width: '.concat(s,'px; position: relative; font-family: var(--font-family-body);">')+R+a()+"\n"+t+'\n<script src="https://code.iconify.design/iconify-icon/3.0.0/iconify-icon.min.js"><\/script></div>'},r[2]=a,r[3]=null==o?void 0:o.htmlCss,r[4]=s,r[5]=n):n=r[5],n},R='<link rel="preconnect" href="https://fonts.googleapis.com">\n<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@100;200;300;400;500;600;700;800;900&family=Geist:wght@100;200;300;400;500;600;700;800;900&family=IBM+Plex+Mono:wght@100;200;300;400;500;600;700&family=IBM+Plex+Sans:wght@100;200;300;400;500;600;700&family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Nunito:wght@200;300;400;500;600;700;800;900&family=PT+Serif:wght@400;700&family=Roboto+Slab:wght@100;200;300;400;500;600;700;800;900&family=Roboto:wght@100;300;400;500;700;900&family=Shantell+Sans:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">',U=()=>{let e,t=(0,u.c)(1),n=(0,H.p)(),r=(0,F.T)(n),o=(0,m.md)(A.Cr),{effectiveSubscription:i}=(0,P.R)();return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={filters:{mutationKey:["exportToFigma"],status:"pending"}},t[0]=e):e=t[0],(0,M.S)(e).length>0||!i||r||o};function X(e){let[t,n]=e;return"  ".concat(t,": ").concat(n,";")}var Z=n(46676);function K(){return(K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let G=function(e){return p.createElement("svg",K({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),i||(i=p.createElement("path",{d:"M7.75 7L2.5 12L7.75 17M16.25 7L21.5 12L16.25 17",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};function Y(){return(Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let $=function(e){return p.createElement("svg",Y({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=p.createElement("path",{d:"M19.0714 9H16C14.9499 9 14.4248 9 14.0238 9.20436C13.671 9.38413 13.3841 9.67096 13.2044 10.0238C13 10.4248 13 10.9499 13 12V16C13 17.0501 13 17.5751 13.2044 17.9762C13.3841 18.3291 13.671 18.6159 14.0238 18.7956C14.4248 19 14.9499 19 16 19H20C21.0501 19 21.5751 19 21.9762 18.7956C22.3291 18.6159 22.6159 18.3291 22.7956 17.9762C23 17.5751 23 17.0501 23 16V12.9286",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),a||(a=p.createElement("path",{d:"M9 14V19C9 21.2091 10.7909 23 13 23H18",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),s||(s=p.createElement("path",{d:"M24 6V8M24 8H22M24 8V10M24 8H26",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};var J=n(1237);let Q=e=>{let t,n,r,o,i=(0,u.c)(13),{content:l,tooltip:a,exportFunction:s}=e,d=(()=>{let{flow:e}=(0,p.useContext)(L.c);return"web-html-css"===e.genType||"mobile-html-css"===e.genType})(),m=U();if(!d)return null;let f=!m&&"hover:bg-white/20",g=m&&"opacity-50";return i[0]!==f||i[1]!==g?(t=(0,h.cn)("flex h-8 w-8 items-center justify-center rounded-lg text-white transition-colors",f,g),i[0]=f,i[1]=g,i[2]=t):t=i[2],i[3]!==l||i[4]!==s||i[5]!==m||i[6]!==t?(n=(0,c.jsx)(Z.k$,{asChild:!0,children:(0,c.jsx)("button",{className:t,onClick:s,disabled:m,children:l})}),i[3]=l,i[4]=s,i[5]=m,i[6]=t,i[7]=n):n=i[7],i[8]!==a?(r=(0,c.jsx)(Z.ZI,{sideOffset:8,children:a}),i[8]=a,i[9]=r):r=i[9],i[10]!==n||i[11]!==r?(o=(0,c.jsxs)(Z.m_,{children:[n,r]}),i[10]=n,i[11]=r,i[12]=o):o=i[12],o},q=()=>{let e,t,r=(0,u.c)(3),o=(()=>{let e=(0,V.d)().user.id,t=(0,H.p)(),{effectiveSubscription:r}=(0,P.R)(),{flow:o}=(0,p.useContext)(L.c),i=o.id,l={flowId:i,userId:e,chatId:t},a=B(t),s=async()=>{try{let[e,{default:t},{default:r},{default:o},{default:i}]=await Promise.all([a(),n.e(5618).then(n.bind(n,35618)),n.e(4015).then(n.bind(n,14015)),n.e(3241).then(n.bind(n,83241)),n.e(8294).then(n.bind(n,74630))]),s=await t.format(e,{parser:"html",plugins:[r,o,i]});await navigator.clipboard.writeText(s),j.A.logEvent("[Flow] Copy to HTML/CSS success",l)}catch(n){console.error("Error copying to HTML/CSS :",n),O.Cp(n),j.A.logEvent("[Flow] Copy to HTML/CSS error",{userId:e,flowId:i,chatId:t,...n instanceof Error?{error:n.message}:{}})}};return()=>{if(j.A.logEvent("[Flow] Copy to HTML/CSS click",l),!(null==r?void 0:r.canExportToFigma)){window.location.href="/subscription?source=export-to-html-css";return}N.oR.promise(s(),{loading:"Exporting to HTML/CSS...",success:'Copied, press "Cmd+V" in your editor',error:"Error exporting to HTML/CSS, try again."})}})();return r[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,c.jsx)(G,{}),r[0]=e):e=r[0],r[1]!==o?(t=(0,c.jsx)(Q,{content:e,tooltip:"Copy HTML/CSS",exportFunction:o}),r[1]=o,r[2]=t):t=r[2],t},ee=()=>{let e,t,n=(0,u.c)(4),{handleExportClick:r,isPending:o}=(()=>{let{flow:e}=(0,p.useContext)(L.c),t=e.id,n=(0,H.p)(),r=(0,V.d)().user.id,{effectiveSubscription:o}=(0,P.R)(),i=B(n),l=(0,_.n)({mutationKey:["exportToFigma"],mutationFn:async()=>{let e=new ClipboardItem({"text/html":(async()=>{let e=await fetch("/api/export-to-figma",{method:"POST",headers:{"Content-Type":"text/html"},body:await i()}),t=await e.text();if(!e.ok)throw Error(t||"HTTP error! status: ".concat(e.status));return t})()});await navigator.clipboard.write([e]),j.A.logEvent("[Flow] Copy to Figma success",{userId:r,flowId:t,chatId:n})},onError:e=>{console.error("Error copying to Figma:",e),O.Cp(e),j.A.logEvent("[Flow] Copy to Figma error",{userId:r,flowId:t,chatId:n,error:e.message})}});return{handleExportClick:()=>{if(j.A.logEvent("[Flow] Copy to Figma click",{userId:r,flowId:t,chatId:n}),!(null==o?void 0:o.canExportToFigma)){window.location.href="/subscription?source=export-to-figma";return}N.oR.promise(l.mutateAsync(),{loading:"Exporting to Figma...",success:'Copied, press "Cmd+V" in Figma',error:"Error exporting to Figma, try again"})},isPending:(0,M.S)({filters:{mutationKey:["exportToFigma"],status:"pending"}}).length>0}})(),i=U();n[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,c.jsx)(J.A,{}),n[0]=e):e=n[0];let l=o?"Copying...":i?"Copy to Figma is not available":"Copy to Figma";return n[1]!==r||n[2]!==l?(t=(0,c.jsx)(Q,{content:e,tooltip:l,exportFunction:r}),n[1]=r,n[2]=l,n[3]=t):t=n[3],t},et=e=>{let t,n,r,o=(0,u.c)(6),{screenId:i}=e,l=(0,E.iW)();o[0]!==l||o[1]!==i?(t=()=>{j.A.logEvent("[Flow] screen duplicate",{source:"canvas"}),N.oR.promise(l.mutateAsync({screenId:i}),{loading:"Duplicating screen...",success:"Screen duplicated successfully",error:"Error duplicating screen, try again"})},o[0]=l,o[1]=i,o[2]=t):t=o[2];let a=t;return o[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,c.jsx)($,{}),o[3]=n):n=o[3],o[4]!==a?(r=(0,c.jsx)(Q,{content:n,tooltip:"Duplicate screen",exportFunction:a}),o[4]=a,o[5]=r):r=o[5],r};var en=n(41611),er=n(78837),eo=n(80035);let ei="calc(12px * var(--inverse-zoom, 1))",el="calc(8px * var(--inverse-zoom, 1))",ea=e=>{let t,n,r,o,i,l,a=(0,u.c)(14),{position:s,onCreateScreen:d}=e;return a[0]!==s?(t=(e=>{switch(e){case"left":return{left:"calc(-1 * ".concat(ei,")"),top:0,width:ei,height:"100%"};case"right":return{right:"calc(-1 * ".concat(ei,")"),top:0,width:ei,height:"100%"};case"bottom":return{bottom:"calc(-1 * ".concat(ei,")"),left:0,width:"100%",height:ei}}})(s),a[0]=s,a[1]=t):t=a[1],a[2]!==d||a[3]!==s?(n=e=>{e.stopPropagation(),d(s)},a[2]=d,a[3]=s,a[4]=n):n=a[4],a[5]!==s?(r=(e=>{let t={position:"absolute",transform:"scale(var(--inverse-zoom, 1))"};switch(e){case"left":return{...t,right:el,top:"50%",transform:"translateY(-50%) scale(var(--inverse-zoom, 1))",transformOrigin:"center right"};case"right":return{...t,left:el,top:"50%",transform:"translateY(-50%) scale(var(--inverse-zoom, 1))",transformOrigin:"center left"};case"bottom":return{...t,top:el,left:"50%",transform:"translateX(-50%) scale(var(--inverse-zoom, 1))",transformOrigin:"top center"}}})(s),a[5]=s,a[6]=r):r=a[6],a[7]===Symbol.for("react.memo_cache_sentinel")?(o=(0,c.jsx)("div",{className:"shadow-ui-sm flex h-8 w-8 flex-shrink-0 scale-90 items-center justify-center rounded-full bg-tooltip text-white opacity-0 transition-[transform,opacity] duration-75 group-hover:scale-100 group-hover:opacity-100",children:(0,c.jsx)(eo.A,{className:"h-6 w-6"})}),a[7]=o):o=a[7],a[8]!==r?(i=(0,c.jsx)("div",{style:r,children:o}),a[8]=r,a[9]=i):i=a[9],a[10]!==t||a[11]!==n||a[12]!==i?(l=(0,c.jsx)("div",{className:"group absolute z-10 flex cursor-pointer items-center justify-center",style:t,onClick:n,children:i}),a[10]=t,a[11]=n,a[12]=i,a[13]=l):l=a[13],l};var es=n(15551),ec=n(37601),eu=n(85665);function ed(e){let t,n,r,o,i,l,a,s,d,m,p,f,g=(0,u.c)(23),{isActive:v,screenId:y}=e;g[0]===Symbol.for("react.memo_cache_sentinel")?(t={position:"absolute",left:"50%",transform:"translateX(-50%)",top:"calc(-50px * var(--inverse-zoom, 1))",width:"200px",height:"calc(50px * var(--inverse-zoom, 1))"},g[0]=t):t=g[0];let x=v?"pointer-events-auto":"pointer-events-none";g[1]!==x?(n=(0,h.cn)("z-[39] group-hover:pointer-events-auto",x),g[1]=x,g[2]=n):n=g[2],g[3]!==n?(r=(0,c.jsx)("div",{style:t,className:n}),g[3]=n,g[4]=r):r=g[4],g[5]===Symbol.for("react.memo_cache_sentinel")?(o={transform:"translate(-50%, 0) scale(var(--inverse-zoom, 1))",transformOrigin:"center top",top:"calc(-50px * var(--inverse-zoom, 1))",left:"50%",position:"absolute"},g[5]=o):o=g[5];let w=v?"pointer-events-auto":"pointer-events-none";g[6]!==w?(i=(0,h.cn)("z-[40] group-hover:pointer-events-auto",w),g[6]=w,g[7]=i):i=g[7];let b=v?"scale-100 opacity-100":"scale-95 opacity-0";return g[8]!==b?(l=(0,h.cn)("shadow-ui-sm flex flex-row items-center justify-center rounded-xl bg-tooltip p-1 transition-[transform,opacity] duration-75 group-hover:scale-100 group-hover:opacity-100",b),g[8]=b,g[9]=l):l=g[9],g[10]!==y?(a=(0,c.jsx)(et,{screenId:y}),g[10]=y,g[11]=a):a=g[11],g[12]===Symbol.for("react.memo_cache_sentinel")?(s=(0,c.jsx)(ee,{}),d=(0,c.jsx)(q,{}),g[12]=s,g[13]=d):(s=g[12],d=g[13]),g[14]!==a||g[15]!==l?(m=(0,c.jsxs)("div",{className:l,children:[a,s,d]}),g[14]=a,g[15]=l,g[16]=m):m=g[16],g[17]!==m||g[18]!==i?(p=(0,c.jsx)("div",{style:o,className:i,children:m}),g[17]=m,g[18]=i,g[19]=p):p=g[19],g[20]!==p||g[21]!==r?(f=(0,c.jsxs)("div",{children:[r,p]}),g[20]=p,g[21]=r,g[22]=f):f=g[22],f}let em=(0,p.memo)(function(e){let t,n,r,o,i,l,a,s,d,f=(0,u.c)(35),{data:g}=e,{flowId:v,chatId:y,index:x}=g,{genType:w}=(0,p.useContext)(L.c).flow,E=(0,eu.a)(y),C=(0,b.d)(),_=(0,m.md)(en.X),M=(0,m.md)(er.ET),T=(0,m.md)(er.Ec),{createScreenRelativeTo:I}=(0,es.M)(),{readonly:N}=(0,p.useContext)(ec.U);f[0]!==y||f[1]!==C?(t=()=>{C(y)},f[0]=y,f[1]=C,f[2]=t):t=f[2];let O=t;f[3]!==I||f[4]!==y?(n=e=>{j.A.logEvent("[Flow] add new screen from border",{position:e,chatId:y}),I(y,e)},f[3]=I,f[4]=y,f[5]=n):n=f[5];let F=n,A=y===T&&"partial-edit"===_&&null!==M;return f[6]===Symbol.for("react.memo_cache_sentinel")?(r=(0,h.cn)("flex cursor-auto flex-col","group"),f[6]=r):r=f[6],f[7]!==v||f[8]!==w||f[9]!==x||f[10]!==E||f[11]!==y?(o=(0,c.jsx)("div",{className:"flex justify-between",children:(0,c.jsx)(k,{currentChatId:y,arrId:x,flowId:v,isActiveFrame:E,genType:w})}),f[7]=v,f[8]=w,f[9]=x,f[10]=E,f[11]=y,f[12]=o):o=f[12],f[13]!==E||f[14]!==N||f[15]!==y?(i=!N&&(0,c.jsx)(ed,{isActive:E,screenId:y}),f[13]=E,f[14]=N,f[15]=y,f[16]=i):i=f[16],f[17]!==v||f[18]!==w||f[19]!==A||f[20]!==E||f[21]!==y?(l=(0,c.jsx)(S.w,{flowId:v,chatId:y,isActiveFrame:E,genType:w,hasPartialSelection:A}),f[17]=v,f[18]=w,f[19]=A,f[20]=E,f[21]=y,f[22]=l):l=f[22],f[23]!==F||f[24]!==N?(a=!N&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ea,{position:"left",onCreateScreen:F}),(0,c.jsx)(ea,{position:"right",onCreateScreen:F}),(0,c.jsx)(ea,{position:"bottom",onCreateScreen:F})]}),f[23]=F,f[24]=N,f[25]=a):a=f[25],f[26]!==O||f[27]!==y||f[28]!==i||f[29]!==l||f[30]!==a?(s=(0,c.jsxs)("div",{onClick:O,id:y,className:"relative",children:[i,l,a]}),f[26]=O,f[27]=y,f[28]=i,f[29]=l,f[30]=a,f[31]=s):s=f[31],f[32]!==o||f[33]!==s?(d=(0,c.jsxs)("div",{className:r,children:[o,s]}),f[32]=o,f[33]=s,f[34]=d):d=f[34],d},(e,t)=>e.data.chatId===t.data.chatId&&e.data.flowId===t.data.flowId&&e.data.index===t.data.index&&e.data.isDragging===t.data.isDragging);var ep=n(38254),eh=n(27806),ef=n(77041);let eg=e=>"banani-flow-viewport-".concat(e),ev=e=>"banani-flow-lastSelectedScreenId-".concat(e),ey=ef.object({x:ef.number(),y:ef.number(),zoom:ef.number()});function ex(){let e,t,n=(0,u.c)(4),r=(0,H.p)(),{flow:o}=(0,p.useContext)(L.c);return n[0]!==r||n[1]!==o.id?(e=()=>{if(r){var e;e=o.id,localStorage.setItem(ev(e),r)}},t=[r,o.id],n[0]=r,n[1]=o.id,n[2]=e,n[3]=t):(e=n[2],t=n[3]),(0,p.useEffect)(e,t),null}function ew(e){return"position"===e.type&&void 0!==e.position}function eb(e){return[e.id,e.position]}let eE=()=>{let e,t,n,r=(0,u.c)(5),o=(0,d.Pj)(eC);return r[0]!==o?(e=()=>{o&&(o.style.setProperty("--canvas-zoom","1"),o.style.setProperty("--inverse-zoom","1"))},t=[o],r[0]=o,r[1]=e,r[2]=t):(e=r[1],t=r[2]),(0,p.useLayoutEffect)(e,t),r[3]!==o?(n={onChange:e=>{o&&(o.style.setProperty("--canvas-zoom",String(e.zoom)),o.style.setProperty("--inverse-zoom",String(1/e.zoom)))}},r[3]=o,r[4]=n):n=r[4],(0,d.bk)(n),null};function eC(e){return e.domNode}let ek={frame:em},ej=()=>{let e,t,n,r,o=(0,u.c)(11),{nodes:i,onNodesChange:l,onNodeDragStart:a,onNodeDragStop:s,onMoveEnd:m,isDragging:h}=(()=>{let e,t,n,r,o,i,l,a,s,c,m=(0,u.c)(34),{flow:h}=(0,p.useContext)(L.c),{id:f,genType:g}=h,v=ep.i.useUtils(),y=(0,b.d)();m[0]!==f?(e={flowId:f},m[0]=f,m[1]=e):e=m[1];let{data:x}=ep.i.getFlowScreens.useQuery(e);m[2]!==x?(t=void 0===x?[]:x,m[2]=x,m[3]=t):t=m[3];let w=t,E=ep.i.updateScreen.useMutation(),{fitViewToChat:k}=(0,eh.k)(),{setViewport:S}=(0,d.VH)(),[_,M]=(0,p.useState)(null);if(m[4]!==_||m[5]!==f||m[6]!==g||m[7]!==w){let e;m[9]!==_||m[10]!==f||m[11]!==g?(e=(e,t)=>((e,t,n,r,o,i,l)=>{let{width:a,height:s,offset:c}=(0,C.u)(r);return{id:t,type:"frame",position:{x:null!=i?i:c*n,y:null!=l?l:0},width:a,height:s,data:{chatId:t,flowId:e,index:n,isDragging:o}}})(f,e.id,t,g,_===e.id,e.x,e.y),m[9]=_,m[10]=f,m[11]=g,m[12]=e):e=m[12],n=w.map(e),m[4]=_,m[5]=f,m[6]=g,m[7]=w,m[8]=n}else n=m[8];let T=n;m[13]!==f||m[14]!==v?(r=e=>{let t=e.filter(ew);0!==t.length&&v.getFlowScreens.setData({flowId:f},e=>{if(!e)return e;let n=new Map(t.map(eb));return e.map(e=>{let t=n.get(e.id);return t?{...e,x:t.x,y:t.y}:e})})},m[13]=f,m[14]=v,m[15]=r):r=m[15];let I=r,N=(0,p.useRef)(!1);m[16]!==k||m[17]!==f||m[18]!==w||m[19]!==y||m[20]!==S?(o=()=>{var e;if(0===w.length||N.current)return;let t=function(e){let t=eg(e),n=localStorage.getItem(t);if(!n)return null;try{return ey.parse(JSON.parse(n))}catch(r){return O.Cp(r,{tags:{area:"canvas"},extra:{flowId:e,savedViewport:n}}),localStorage.removeItem(t),null}}(f);t&&setTimeout(()=>void S(t),0);let n=localStorage.getItem(ev(f)),r=w[w.length-1],o=null!=(e=w.find(e=>e.id===n))?e:r;t||setTimeout(()=>void k(o.id,{duration:0}),0),y(o.id),N.current=!0},i=[w,k,y,f,S],m[16]=k,m[17]=f,m[18]=w,m[19]=y,m[20]=S,m[21]=o,m[22]=i):(o=m[21],i=m[22]),(0,p.useEffect)(o,i),m[23]!==f?(l=(e,t)=>{localStorage.setItem(eg(f),JSON.stringify(t))},m[23]=f,m[24]=l):l=m[24];let F=l;m[25]===Symbol.for("react.memo_cache_sentinel")?(a=(e,t)=>{"frame"===t.type&&M(t.id)},m[25]=a):a=m[25];let A=a;m[26]!==E?(s=(e,t)=>{"frame"===t.type&&(M(null),j.A.logEvent("[Flow] canvas node dragged",{screenId:t.id,x:Math.round(t.position.x),y:Math.round(t.position.y)}),E.mutate({screenId:t.id,updates:{x:Math.round(t.position.x),y:Math.round(t.position.y)}}))},m[26]=E,m[27]=s):s=m[27];let H=s,P=null!==_;return m[28]!==T||m[29]!==F||m[30]!==H||m[31]!==I||m[32]!==P?(c={nodes:T,onNodesChange:I,onNodeDragStart:A,onNodeDragStop:H,onMoveEnd:F,isDragging:P},m[28]=T,m[29]=F,m[30]=H,m[31]=I,m[32]=P,m[33]=c):c=m[33],c})(),f=!(0,p.useContext)(ec.U).readonly;o[0]===Symbol.for("react.memo_cache_sentinel")?(e={hideAttribution:!0},o[0]=e):e=o[0];let g=h?"dragging-node":"";return o[1]===Symbol.for("react.memo_cache_sentinel")?(t=(0,c.jsx)(eE,{}),n=(0,c.jsx)(ex,{}),o[1]=t,o[2]=n):(t=o[1],n=o[2]),o[3]!==i||o[4]!==f||o[5]!==m||o[6]!==a||o[7]!==s||o[8]!==l||o[9]!==g?(r=(0,c.jsxs)(d.Gc,{nodesDraggable:f,panOnScroll:!0,minZoom:.1,proOptions:e,nodeTypes:ek,nodes:i,onNodesChange:l,onNodeDragStart:a,onNodeDragStop:s,zoomOnDoubleClick:!1,deleteKeyCode:null,onMoveEnd:m,className:g,children:[t,n]}),o[3]=i,o[4]=f,o[5]=m,o[6]=a,o[7]=s,o[8]=l,o[9]=g,o[10]=r):r=o[10],r}},34970:(e,t,n)=>{n.d(t,{d:()=>u});var r=n(19749),o=n(12115),i=n(89086),l=n(3585),a=n(41611),s=n(37601),c=n(48842);let u=e=>{let t,n,u,m,p,h=(0,r.c)(15),f=(0,i.Xr)(l.d),g=(0,i.md)(a.X),{readonly:v}=(0,o.useContext)(s.U),[y,x]=(0,o.useState)(null);h[0]!==e||h[1]!==y||h[2]!==f?(t=t=>{if(!y)return;c.A.logEvent("[Chat] generate next screen confirmed",{nextScreen:y});let n="Generate next step in the flow when I press on the '".concat(y,"'"),r=t?"".concat(n,". ").concat(t):n;x(null),e().then(()=>{c.A.logEvent("[Chat] prototype next screen",{nextScreen:y,promps:r}),setTimeout(()=>{f(r)},1e3)}).catch(d)},h[0]=e,h[1]=y,h[2]=f,h[3]=t):t=h[3];let w=t;h[4]!==y?(n=()=>{y&&(c.A.logEvent("[Chat] generate next screen cancelled",{nextScreen:y}),x(null))},h[4]=y,h[5]=n):n=h[5];let b=n;h[6]!==g||h[7]!==v?(u=()=>{let e=e=>{if("generate"!==g)return;let t=e.target;for(;null!==t;){if("banani-button"===t.dataset.mediaType){if(c.A.logEvent("[Chat] prototype element clicked"),v){c.A.logEvent("[Preview] try banani click from button"),window.open("/auth/signup","_blank");return}let e=function(e){let t,n=[],r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT);for(;t=r.nextNode();){var o,i;let e=null!=(i=null==(o=t.textContent)?void 0:o.trim())?i:"";e&&n.push(e)}return n}(t);0===e.length&&(e=t.dataset.mediaAction?[t.dataset.mediaAction]:[""]);let n=e.join(", ");if(!n)return;c.A.logEvent("[Chat] generate next screen modal shown",{nextScreen:n}),x(n);return}t=t.parentElement}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},m=[g,v],h[6]=g,h[7]=v,h[8]=u,h[9]=m):(u=h[8],m=h[9]),(0,o.useEffect)(u,m);let E=!!y,C=null!=y?y:"";return h[10]!==b||h[11]!==w||h[12]!==E||h[13]!==C?(p={isModalOpen:E,pendingNextScreen:C,handleConfirm:w,handleCancel:b},h[10]=b,h[11]=w,h[12]=E,h[13]=C,h[14]=p):p=h[14],p};function d(e){console.error("Error in banani button callback:",e)}},80035:(e,t,n)=>{n.d(t,{A:()=>l});var r,o=n(12115);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let l=function(e){return o.createElement("svg",i({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=o.createElement("path",{d:"M10 9.99928L5 9.99898M10 9.99928V14.9998M10 9.99928V5M10 9.99928L15 9.99898",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})))}},90084:(e,t,n)=>{n.d(t,{G:()=>y});var r,o,i,l,a=n(95155),s=n(19749),c=n(12115);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let d=function(e){return c.createElement("svg",u({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("g",{clipPath:"url(#clip0_3000_1527)"},c.createElement("path",{d:"M7 12H17",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}))),o||(o=c.createElement("defs",null,c.createElement("clipPath",{id:"clip0_3000_1527"},c.createElement("rect",{width:24,height:24,fill:"currentColor"})))))};function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let p=function(e){return c.createElement("svg",m({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),i||(i=c.createElement("g",{clipPath:"url(#clip0_3000_1523)"},c.createElement("path",{d:"M12 7V17",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),c.createElement("path",{d:"M7 12H17",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}))),l||(l=c.createElement("defs",null,c.createElement("clipPath",{id:"clip0_3000_1523"},c.createElement("rect",{width:24,height:24,fill:"currentColor"})))))};var h=n(46676),f=n(27806),g=n(63879);function v(e){return e.transform[2]}let y=()=>{let e,t,n,r,o,i,l,u,m,g,v,y,w,b,E,C=(0,s.c)(26),{zoomIn:k,zoomOut:j}=(0,f.k)();C[0]!==k||C[1]!==j?(e=e=>{let t=document.activeElement;if(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||(null==t?void 0:t.hasAttribute("contenteditable")))){if("="===e.key||"+"===e.key)return void k();if("-"===e.key)return void j()}},C[0]=k,C[1]=j,C[2]=e):e=C[2];let S=e;return C[3]!==S?(t=()=>(window.addEventListener("keydown",S),()=>{window.removeEventListener("keydown",S)}),n=[S],C[3]=S,C[4]=t,C[5]=n):(t=C[4],n=C[5]),(0,c.useEffect)(t,n),C[6]!==j?(r=()=>void j(),C[6]=j,C[7]=r):r=C[7],C[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,a.jsx)(d,{}),C[8]=o):o=C[8],C[9]!==r?(i=(0,a.jsx)(h.k$,{asChild:!0,children:(0,a.jsx)("button",{className:"-mr-0.5 flex items-center justify-center rounded-lg text-muted-foreground transition-colors",onClick:r,children:o})}),C[9]=r,C[10]=i):i=C[10],C[11]===Symbol.for("react.memo_cache_sentinel")?(l=(0,a.jsx)(h.ZI,{sideOffset:8,children:"Zoom out"}),C[11]=l):l=C[11],C[12]!==i?(u=(0,a.jsxs)(h.m_,{children:[i,l]}),C[12]=i,C[13]=u):u=C[13],C[14]===Symbol.for("react.memo_cache_sentinel")?(m=(0,a.jsx)(x,{}),C[14]=m):m=C[14],C[15]!==k?(g=()=>void k(),C[15]=k,C[16]=g):g=C[16],C[17]===Symbol.for("react.memo_cache_sentinel")?(v=(0,a.jsx)(p,{}),C[17]=v):v=C[17],C[18]!==g?(y=(0,a.jsx)(h.k$,{asChild:!0,children:(0,a.jsx)("button",{className:"-ml-1 flex items-center justify-center rounded-lg text-muted-foreground transition-colors",onClick:g,children:v})}),C[18]=g,C[19]=y):y=C[19],C[20]===Symbol.for("react.memo_cache_sentinel")?(w=(0,a.jsx)(h.ZI,{sideOffset:8,children:"Zoom in"}),C[20]=w):w=C[20],C[21]!==y?(b=(0,a.jsxs)(h.m_,{children:[y,w]}),C[21]=y,C[22]=b):b=C[22],C[23]!==b||C[24]!==u?(E=(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[u,m,b]}),C[23]=b,C[24]=u,C[25]=E):E=C[25],E},x=()=>{let e,t=(0,s.c)(2),n=Math.floor(100*(0,g.Pj)(v));return t[0]!==n?(e=(0,a.jsxs)("div",{className:"w-[40px] text-center text-[14px] font-semibold text-muted-foreground",children:[n,"%"]}),t[0]=n,t[1]=e):e=t[1],e}},94362:(e,t,n)=>{n.d(t,{o:()=>p});var r,o,i=n(95155),l=n(19749),a=n(89086),s=n(6799),c=n(12115),u=n(41611);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}let m=function(e){return c.createElement("svg",d({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{d:"M4.375 8.375L5.5 5L6.625 8.375L10 9.5L6.625 10.625L5.5 14L4.375 10.625L1 9.5L4.375 8.375Z",fill:"currentColor",stroke:"currentColor",strokeWidth:2,strokeLinejoin:"round"})),o||(o=c.createElement("path",{d:"M13 2V4M13 4H11M13 4V6M13 4H15",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))},p=()=>{let e,t,n,r,o,d,p,h=(0,l.c)(15),{isTooltipOpen:f,mousePosition:g}=(()=>{let e,t,n,r,o=(0,l.c)(7),[i,a]=(0,c.useState)(!1);o[0]===Symbol.for("react.memo_cache_sentinel")?(e={x:0,y:0},o[0]=e):e=o[0];let[s,u]=(0,c.useState)(e);return o[1]!==i?(t=()=>{let e=e=>{u({x:e.clientX,y:e.clientY})},t=t=>{t.target instanceof HTMLElement&&t.target.closest('[data-media-type="banani-button"]')&&(a(!0),e(t))},n=e=>{e.target instanceof HTMLElement&&e.target.closest('[data-media-type="banani-button"]')&&a(!1)},r=t=>{i&&e(t)};return document.addEventListener("mouseover",t),document.addEventListener("mousemove",r),document.addEventListener("mouseout",n),()=>{document.removeEventListener("mouseover",t),document.removeEventListener("mousemove",r),document.removeEventListener("mouseout",n)}},n=[i],o[1]=i,o[2]=t,o[3]=n):(t=o[2],n=o[3]),(0,c.useEffect)(t,n),o[4]!==i||o[5]!==s?(r={isTooltipOpen:i,mousePosition:s},o[4]=i,o[5]=s,o[6]=r):r=o[6],r})(),v=(0,a.md)(u.X);h[0]===Symbol.for("react.memo_cache_sentinel")?(e={opacity:0,scale:.95},h[0]=e):e=h[0];let y="generate"===v&&f?1:0,x="generate"===v&&f?1:.9;h[1]!==y||h[2]!==x?(t={opacity:y,scale:x},h[1]=y,h[2]=x,h[3]=t):t=h[3];let w="generate"===v&&f?.1:.05;h[4]===Symbol.for("react.memo_cache_sentinel")?(n=[.42,0,.58,1],h[4]=n):n=h[4],h[5]!==w?(r={duration:w,ease:n},h[5]=w,h[6]=r):r=h[6];let b=g.x+10,E=g.y+18;return h[7]!==b||h[8]!==E?(o={left:b,top:E,transformOrigin:"top left"},h[7]=b,h[8]=E,h[9]=o):o=h[9],h[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,i.jsx)(m,{className:"h-4 w-4 text-white"}),h[10]=d):d=h[10],h[11]!==t||h[12]!==r||h[13]!==o?(p=(0,i.jsxs)(s.P.div,{initial:e,animate:t,transition:r,className:"pointer-events-none absolute z-10 flex h-8 w-fit flex-row items-center justify-center gap-1 whitespace-nowrap rounded-xl rounded-tl-sm bg-[hsla(248,100%,68%,1)] pl-2 pr-2.5 text-sm font-semibold text-white drop-shadow-lg backdrop-blur-sm",style:o,children:[d,"Generate screen"]}),h[11]=t,h[12]=r,h[13]=o,h[14]=p):p=h[14],p}},96988:(e,t,n)=>{n.d(t,{e:()=>m});var r=n(95155),o=n(19749),i=n(52779),l=n(12115),a=n(89086),s=n(3585),c=n(48842),u=n(38254),d=n(37601);let m=e=>{let t,n,m,p,h,f,g,v,y,x,w=(0,o.c)(34),{chatId:b,isEditable:E,setIsEditable:C,screenCount:k,className:j,style:S}=e,L=(0,l.useRef)(null),_=(0,a.Xr)(s.Cr),M=(0,l.useContext)(d.U);w[0]!==b?(t={screenId:b},w[0]=b,w[1]=t):t=w[1];let T=""!==b;w[2]!==T?(n={enabled:T},w[2]=T,w[3]=n):n=w[3];let{data:I}=u.i.getScreen.useQuery(t,n),N=null==I?void 0:I.screenName,O=u.i.useUtils();w[4]!==O?(m={onSuccess:async(e,t)=>{let{screenId:n}=t;await O.getScreen.invalidate({screenId:n})}},w[4]=O,w[5]=m):m=w[5];let F=u.i.updateScreen.useMutation(m),A=null!=N?N:"Screen ".concat(k+1);if(w[6]!==E?(p=()=>{E&&null!==L.current&&(L.current.focus(),function(e){let t=document.createRange(),n=window.getSelection();null!==n&&(t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t))}(L.current))},h=[E],w[6]=E,w[7]=p,w[8]=h):(p=w[7],h=w[8]),(0,l.useEffect)(p,h),M.readonly){let e,t;return w[9]!==j?(e=(0,i.cn)(j,"overflow-hidden text-ellipsis whitespace-nowrap"),w[9]=j,w[10]=e):e=w[10],w[11]!==A||w[12]!==S||w[13]!==e?(t=(0,r.jsx)("span",{className:e,style:S,children:A}),w[11]=A,w[12]=S,w[13]=e,w[14]=t):t=w[14],t}return w[15]!==C||w[16]!==_?(f=()=>{C(!0),_(!0)},w[15]=C,w[16]=_,w[17]=f):f=w[17],w[18]===Symbol.for("react.memo_cache_sentinel")?(g=e=>{var t;"Enter"===e.key&&(e.preventDefault(),null==(t=L.current)||t.blur())},w[18]=g):g=w[18],w[19]!==b||w[20]!==N||w[21]!==C||w[22]!==_||w[23]!==F?(v=e=>{null!==L.current&&(L.current.scrollLeft=0),C(!1),_(!1);let{textContent:t}=e.currentTarget;t&&t!==N&&(c.A.logEvent("Screen name change"),F.mutate({screenId:b,updates:{screenName:t.trim()}}))},w[19]=b,w[20]=N,w[21]=C,w[22]=_,w[23]=F,w[24]=v):v=w[24],w[25]!==j?(y=(0,i.cn)(j,"overflow-hidden text-ellipsis whitespace-nowrap focus:overflow-scroll focus:whitespace-pre-wrap"),w[25]=j,w[26]=y):y=w[26],w[27]!==E||w[28]!==A||w[29]!==S||w[30]!==y||w[31]!==f||w[32]!==v?(x=(0,r.jsx)("span",{ref:L,suppressContentEditableWarning:!0,contentEditable:E,onDoubleClick:f,onKeyDown:g,onBlur:v,className:y,style:S,children:A}),w[27]=E,w[28]=A,w[29]=S,w[30]=y,w[31]=f,w[32]=v,w[33]=x):x=w[33],x}}}]);