try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="9ac1a71e-1327-4ecf-aad3-9e6129bd5ddd",e._sentryDebugIdIdentifier="sentry-dbid-9ac1a71e-1327-4ecf-aad3-9e6129bd5ddd")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8771],{7652:(e,t,r)=>{Promise.resolve().then(r.bind(r,31438))},31438:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>tN});var n,l,s,o,a,i,c,d,u,m,p,h,x,f,g,v=r(95155),b=r(19749),y=r(84968),w=r(12115),j=r(66884),k=r(48842),N=r(39200),C=r(89086),E=r(75041),L=r(3585),_=r(23838);function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let I=function(e){return w.createElement("svg",S({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=w.createElement("path",{d:"M8 7L17 12L12.5 13.5L10 17.5L8 7Z",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};function M(){return(M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let O=function(e){return w.createElement("svg",M({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=w.createElement("path",{d:"M11.9995 19V6M11.9995 6L7 11M11.9995 6L17 11.0005",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};var A=r(10518),F=r(78837),D=r(41611),T=r(68899),P=r(97322),R=r(70891),V=r(70383),Y=r(45202),U=r(81760),B=r(45898),H=r(25642),W=r(63323),Z=r(84723),z=r(38254),Q=r(37601);let G=e=>{var t,r,n;let l,s,o,a,i,c,d,u,m,p,h,x,f,g,j,N,S,M,G,$,q,K,X,J,ee,et,er,en,el,es,eo,ea,ei,ec,ed=(0,b.c)(120),{flowId:eu}=e,em=(0,y.p)(),ep=(0,_.S)(),{recentUserMessages:eh}=(0,A.Uh)(em),ex=void 0===eh?"unkown":0===eh.length?"no-previous-messages":"has-previous-messages",[ef,eg]=(0,w.useState)(""),ev=(0,w.useRef)(null),{sendMessage:eb}=(0,A.Tp)(em,eu),ey=(0,C.md)(L.d),[ew,ej]=(0,C.fp)(L.vb),[ek,eN]=(0,C.fp)(F.ET),eC=(0,C.Xr)(D.X);ed[0]!==em||ed[1]!==eu||ed[2]!==eC||ed[3]!==eN?(l=()=>{eN(null),eC("generate"),k.A.logEvent("[Flow] Element deselected",{flowId:eu,chatId:em})},ed[0]=em,ed[1]=eu,ed[2]=eC,ed[3]=eN,ed[4]=l):l=ed[4];let eE=l;ed[5]!==em||ed[6]!==eu||ed[7]!==eC?(s=()=>{eC("partial-edit"),k.A.logEvent("[Flow] Select element clicked",{flowId:eu,chatId:em})},ed[5]=em,ed[6]=eu,ed[7]=eC,ed[8]=s):s=ed[8];let eL=s;ed[9]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{if(ev.current){ev.current.style.height="auto";let e=ev.current.scrollHeight;ev.current.style.height="".concat(Math.min(e,256),"px"),ev.current.style.overflowY=e>256?"auto":"hidden"}},ed[9]=o):o=ed[9];let e_=o;ed[10]===Symbol.for("react.memo_cache_sentinel")?(a=()=>{e_()},ed[10]=a):a=ed[10],ed[11]!==ef?(i=[ef],ed[11]=ef,ed[12]=i):i=ed[12],(0,w.useEffect)(a,i),ed[13]!==ey||ed[14]!==ew||ed[15]!==ex||ed[16]!==eb||ed[17]!==ej?(c=()=>{"unkown"!==ex&&ey&&(ej(""),eb(ey,{previousScreenPrompt:ew}))},d=[ey,ex,ew,ej,eb],ed[13]=ey,ed[14]=ew,ed[15]=ex,ed[16]=eb,ed[17]=ej,ed[18]=c,ed[19]=d):(c=ed[18],d=ed[19]),(0,w.useEffect)(c,d),ed[20]!==eu?(u={flowId:eu},ed[20]=eu,ed[21]=u):u=ed[21];let{data:eS}=z.i.getFlow.useQuery(u),eI=null!=(t=null==eS?void 0:eS.model)?t:B.Gr,eM=null!=(r=null==eS?void 0:eS.pendingReferenceImage)?r:void 0,eO=null!=(n=null==eS?void 0:eS.pendingFigmaScreenshot)?n:void 0,eA=(0,w.useContext)(Q.U),{isUploadingImage:eF,handlePaste:eD,fileInputRef:eT,handleFileChange:eP}=(0,Y.j)({setReferenceImageUrl:e=>void eV.mutateAsync({flowId:eu,updates:{pendingReferenceImage:null!=e?e:null}}),referenceImageUrl:eM,location:"canvas"});ed[22]!==ep||ed[23]!==eA.readonly||ed[24]!==ex||ed[25]!==ek||ed[26]!==eb||ed[27]!==eN||ed[28]!==ef?(m=async()=>{if(ep||"unkown"===ex||eA.readonly)return;let e="has-previous-messages"===ex?"[Flow] generate edits click":"[Flow] generate screen click";k.A.logEvent(e,{prompt:ef}),ek?(await eb(ef,{selectedHtml:ek}),eN(null)):await eb(ef),eg("")},ed[22]=ep,ed[23]=eA.readonly,ed[24]=ex,ed[25]=ek,ed[26]=eb,ed[27]=eN,ed[28]=ef,ed[29]=m):m=ed[29];let eR=m,eV=(0,R.ZA)();ed[30]!==eu||ed[31]!==eV?(p={onImport:async e=>{await eV.mutateAsync({flowId:eu,updates:{pendingFigmaScreenshot:e.screenshotUrl,pendingFigmaHtml:e.html,pendingFigmaUrl:e.figmaUrl,pendingFigmaLastModified:e.lastModified}})},onRemove:async()=>{await eV.mutateAsync({flowId:eu,updates:{pendingFigmaScreenshot:null,pendingFigmaHtml:null,pendingFigmaUrl:null,pendingFigmaLastModified:null}})},location:"canvas"},ed[30]=eu,ed[31]=eV,ed[32]=p):p=ed[32];let eY=(0,U.x)(p);if(eA.readonly){let e,t,r,n;return ed[33]!==eA.reason.title?(e=(0,v.jsx)("div",{className:"text-center text-sm text-black",children:(0,v.jsx)("strong",{children:eA.reason.title})}),ed[33]=eA.reason.title,ed[34]=e):e=ed[34],ed[35]!==eA.reason.description?(t=(0,v.jsx)("div",{className:"text-center text-xs text-muted-foreground",children:eA.reason.description}),ed[35]=eA.reason.description,ed[36]=t):t=ed[36],ed[37]===Symbol.for("react.memo_cache_sentinel")?(r=(0,v.jsx)(W.$,{onClick:H.Q,children:"Contact Us"}),ed[37]=r):r=ed[37],ed[38]!==e||ed[39]!==t?(n=(0,v.jsxs)("div",{className:"shadow-ui-sm flex h-[276px] min-h-[276px] w-[496px] flex-col items-center justify-center gap-4 overflow-hidden rounded-[18px] bg-white px-4 pb-4 pt-4",children:[e,t,r]}),ed[38]=e,ed[39]=t,ed[40]=n):n=ed[40],n}ed[41]!==eR?(h=e=>{e.preventDefault(),eR()},ed[41]=eR,ed[42]=h):h=ed[42],ed[43]===Symbol.for("react.memo_cache_sentinel")?(x=e=>{eg(e.target.value)},ed[43]=x):x=ed[43],ed[44]!==eR?(f=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eR())},ed[44]=eR,ed[45]=f):f=ed[45],ed[46]!==eD||ed[47]!==ep?(g=e=>{ep||eD(e)},ed[46]=eD,ed[47]=ep,ed[48]=g):g=ed[48];let eU="no-previous-messages"===ex?"Describe the screen you want to create…":"Type what to edit on the screen…";ed[49]!==ep||ed[50]!==f||ed[51]!==g||ed[52]!==eU||ed[53]!==ef?(j=(0,v.jsx)("textarea",{ref:ev,id:"input-main",value:ef,onChange:x,onKeyDown:f,onPaste:g,placeholder:eU,autoFocus:!0,rows:1,className:"w-full resize-none overflow-hidden bg-transparent pb-2 text-sm font-normal leading-[22px] text-black scrollbar-hide placeholder:text-muted-foreground focus:outline-none",disabled:ep}),ed[49]=ep,ed[50]=f,ed[51]=g,ed[52]=eU,ed[53]=ef,ed[54]=j):j=ed[54],ed[55]!==eE||ed[56]!==ek?(N=ek&&(0,v.jsxs)("button",{type:"button",className:"relative flex cursor-pointer items-center rounded-lg bg-primary/20 py-0.5 pl-0.5 pr-1.5 transition-opacity hover:opacity-80",onClick:eE,title:"Clear selection",children:[(0,v.jsx)(I,{className:"h-6 w-6 text-black"}),(0,v.jsx)("span",{className:"text-sm font-semibold",children:"Element selected"}),(0,v.jsx)("div",{className:"ml-1 flex h-4 w-4 items-center justify-center rounded-full bg-black/20",children:(0,v.jsx)(E.A,{className:"h-2 w-2 text-black",strokeWidth:6})})]}),ed[55]=eE,ed[56]=ek,ed[57]=N):N=ed[57],ed[58]!==eL||ed[59]!==ex||ed[60]!==ek?(S=!ek&&"has-previous-messages"===ex&&(0,v.jsxs)("button",{type:"button",className:"flex items-center rounded-lg bg-muted py-0.5 pl-0.5 pr-2 transition-opacity hover:opacity-80",onClick:eL,children:[(0,v.jsx)(I,{className:"h-6 w-6 text-muted-foreground"}),(0,v.jsx)("span",{className:"text-sm font-semibold text-muted-foreground",children:"Select"})]}),ed[58]=eL,ed[59]=ex,ed[60]=ek,ed[61]=S):S=ed[61],ed[62]!==N||ed[63]!==S?(M=(0,v.jsxs)("div",{className:"flex items-center gap-1.5",children:[N,S]}),ed[62]=N,ed[63]=S,ed[64]=M):M=ed[64],ed[65]!==eu||ed[66]!==eV?(G=e=>void eV.mutateAsync({flowId:eu,updates:{model:e}}),ed[65]=eu,ed[66]=eV,ed[67]=G):G=ed[67],ed[68]!==ep||ed[69]!==eI||ed[70]!==G?($=(0,v.jsx)(T.B,{origin:"Input",model:eI,setModel:G,selectTriggerClassName:"bg-transparent px-0 pb-0 pt-0 text-muted-foreground transition-opacity hover:opacity-70",disabled:ep}),ed[68]=ep,ed[69]=eI,ed[70]=G,ed[71]=$):$=ed[71],ed[72]!==eY?(q=()=>void eY.handleRemove(),ed[72]=eY,ed[73]=q):q=ed[73],ed[74]!==eT.current?(K=()=>{var e;k.A.logEvent("[Reference Image] upload click",{source:"selected",location:"canvas"}),null==(e=eT.current)||e.click()},ed[74]=eT.current,ed[75]=K):K=ed[75],ed[76]!==eu||ed[77]!==eV?(X=()=>void eV.mutateAsync({flowId:eu,updates:{pendingReferenceImage:null}}),ed[76]=eu,ed[77]=eV,ed[78]=X):X=ed[78],ed[79]!==eY.openModal||ed[80]!==ep||ed[81]!==eF||ed[82]!==eO||ed[83]!==eM||ed[84]!==q||ed[85]!==K||ed[86]!==X?(J=(0,v.jsx)(P.A,{figmaScreenshotUrl:eO,onOpenFigmaModal:eY.openModal,onRemoveFigma:q,referenceImageUrl:eM,onClickImageUpload:K,onRemoveImage:X,isUploadingImage:eF,variant:"dark",disabled:ep}),ed[79]=eY.openModal,ed[80]=ep,ed[81]=eF,ed[82]=eO,ed[83]=eM,ed[84]=q,ed[85]=K,ed[86]=X,ed[87]=J):J=ed[87],ed[88]!==$||ed[89]!==J?(ee=(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[$,J]}),ed[88]=$,ed[89]=J,ed[90]=ee):ee=ed[90];let eB="relative flex h-8 cursor-pointer items-center justify-center rounded-lg px-3 disabled:bg-input disabled:text-muted-subtle ".concat(ep?"bg-muted text-black":"bg-primary text-white"),eH=ep||eF;return ed[91]!==ep?(et=ep?(0,v.jsx)(Z.Z,{}):(0,v.jsx)(O,{className:"h-6 w-6"}),ed[91]=ep,ed[92]=et):et=ed[92],ed[93]!==eB||ed[94]!==eH||ed[95]!==et?(er=(0,v.jsx)("button",{className:eB,disabled:eH,"aria-label":"Generate",children:et}),ed[93]=eB,ed[94]=eH,ed[95]=et,ed[96]=er):er=ed[96],ed[97]!==ee||ed[98]!==er?(en=(0,v.jsxs)("div",{className:"flex items-center gap-2.5",children:[ee,er]}),ed[97]=ee,ed[98]=er,ed[99]=en):en=ed[99],ed[100]!==M||ed[101]!==en?(el=(0,v.jsxs)("div",{className:"flex items-end justify-between",children:[M,en]}),ed[100]=M,ed[101]=en,ed[102]=el):el=ed[102],ed[103]!==eY?(es=e=>{eY.handleImport(e)},ed[103]=eY,ed[104]=es):es=ed[104],ed[105]!==eY.closeModal||ed[106]!==eY.isFigmaModalOpen||ed[107]!==es?(eo=(0,v.jsx)(V.C,{isOpen:eY.isFigmaModalOpen,onClose:eY.closeModal,onConfirm:es,location:"canvas"}),ed[105]=eY.closeModal,ed[106]=eY.isFigmaModalOpen,ed[107]=es,ed[108]=eo):eo=ed[108],ed[109]!==eP?(ea=e=>void eP(e),ed[109]=eP,ed[110]=ea):ea=ed[110],ed[111]!==eT||ed[112]!==ea?(ei=(0,v.jsx)("input",{ref:eT,type:"file",accept:"image/png, image/jpeg, image/webp",onChange:ea,className:"hidden"}),ed[111]=eT,ed[112]=ea,ed[113]=ei):ei=ed[113],ed[114]!==h||ed[115]!==j||ed[116]!==el||ed[117]!==eo||ed[118]!==ei?(ec=(0,v.jsxs)("form",{className:"flex w-[390px] flex-col gap-1 overflow-hidden rounded-[18px] bg-white p-3.5 shadow-[0_0px_1px_0_rgba(0,0,0,0.30),0_8px_20px_0_rgba(0,0,0,0.08)]",onSubmit:h,children:[j,el,eo,ei]}),ed[114]=h,ed[115]=j,ed[116]=el,ed[117]=eo,ed[118]=ei,ed[119]=ec):ec=ed[119],ec},$=e=>{let t,r,n,l=(0,b.c)(4),{flowId:s}=e;return l[0]===Symbol.for("react.memo_cache_sentinel")?(t=[],l[0]=t):t=l[0],(0,w.useEffect)(q,t),l[1]===Symbol.for("react.memo_cache_sentinel")?(r={fontFamily:"'Inter', sans-serif"},l[1]=r):r=l[1],l[2]!==s?(n=(0,v.jsx)("div",{id:"tour-promptbox",style:r,className:"absolute bottom-[4px] left-1/2 z-10 flex max-h-[100vh] -translate-x-1/2 flex-col items-center gap-[4px] scrollbar-hide",children:(0,v.jsx)(G,{flowId:s})}),l[2]=s,l[3]=n):n=l[3],n};function q(){k.A.logEvent("[Chat] message list rendered")}var K=r(11345),X=r(62886),J=r(683);function ee(e){let t,r,n,l,s,o,a,i=(0,b.c)(18),{isOpen:c,onClose:d,onConfirm:u,nextScreen:m}=e,[p,h]=(0,w.useState)(""),x=(0,w.useRef)(null);i[0]!==c?(t=()=>{c&&setTimeout(()=>{var e;null==(e=x.current)||e.focus()},100)},r=[c],i[0]=c,i[1]=t,i[2]=r):(t=i[1],r=i[2]),(0,w.useEffect)(t,r),i[3]!==d?(n=()=>{h(""),d()},i[3]=d,i[4]=n):n=i[4];let f=n;i[5]!==p||i[6]!==u?(l=()=>{u(p.trim()),h("")},i[5]=p,i[6]=u,i[7]=l):l=i[7];let g=l;return i[8]===Symbol.for("react.memo_cache_sentinel")?(s={initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15}},i[8]=s):s=i[8],i[9]!==p||i[10]!==f||i[11]!==g||i[12]!==m?(o=(0,v.jsx)(K.g,{className:"rounded-[18px] p-4",children:()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{onClick:f,className:"absolute right-[16px] top-[18px] rounded-sm opacity-70 transition-opacity hover:opacity-100",children:(0,v.jsx)(J.A,{className:"text-muted-foreground"})}),(0,v.jsx)("div",{className:"mb-1 text-sm font-semibold",children:"Generate next screen?"}),(0,v.jsxs)("div",{className:"mb-3 line-clamp-2 text-sm font-normal text-muted-foreground",children:["We're going to predict and generate what happens when users click on \"",m,'".']}),(0,v.jsx)("textarea",{ref:x,className:"mb-4 w-full resize-none rounded-lg bg-muted p-2 text-sm text-black placeholder:text-muted-foreground focus:bg-muted",placeholder:"What to include or how the next screen should look (optional)...",rows:4,value:p,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g())}}),(0,v.jsxs)(W.$,{onClick:g,variant:"primary",size:"sm",className:"flex items-center justify-center",children:["Generate",(0,v.jsx)("img",{src:"/create.svg",className:"h-6 w-6"})]})]})}),i[9]=p,i[10]=f,i[11]=g,i[12]=m,i[13]=o):o=i[13],i[14]!==f||i[15]!==c||i[16]!==o?(a=(0,v.jsx)(X.Y,{backdrop:"opaque",isOpen:c,onClose:f,className:"w-[364px] bg-white text-black",hideCloseButton:!0,motionProps:s,children:o}),i[14]=f,i[15]=c,i[16]=o,i[17]=a):a=i[17],a}var et=r(19817),er=r(45191),en=r(20855),el=r(52779),es=r(96988),eo=r(26052),ea=r(69172),ei=r(27806),ec=r(47650),ed=r(58109),eu=r.n(ed),em=r(19013),ep=r(55902),eh=r(72869);function ex(){return(ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let ef=function(e){return w.createElement("svg",ex({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),s||(s=w.createElement("path",{opacity:.9,d:"M16 12H8",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};var eg=r(58506);function ev(){return(ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let eb=function(e){return w.createElement("svg",ev({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),o||(o=w.createElement("path",{d:"M8 6C8 4.89543 8.89543 4 10 4H14C15.1046 4 16 4.89543 16 6V10C16 11.1046 15.1046 12 14 12M5 17H9C10.1046 17 11 16.1046 11 15V11C11 9.89543 10.1046 9 9 9H5C3.89543 9 3 9.89543 3 11V15C3 16.1046 3.89543 17 5 17Z",stroke:"currentColor",strokeWidth:2})))},ey=w.memo(e=>{let t,r,n,l,s,o,a,i,c,d,u,m,p,h,x,f,g,y,j,N,C,E,L,_,S,I=(0,b.c)(83),{chatId:M,item:O,isActive:A,onSelect:F,onSetStructureId:D,flowId:T,setIsHoveringItem:P,itemRef:R}=e;I[0]!==O.id?(t={structureId:O.id},I[0]=O.id,I[1]=t):t=I[1];let{data:V}=z.i.getPreviousUserMessage.useQuery(t),[Y,U]=w.useState(!1),B=z.i.useUtils();I[2]!==O.id?(r={structureId:O.id},I[2]=O.id,I[3]=r):r=I[3];let{data:H}=z.i.getLikeFeedback.useQuery(r),{isOpen:W,onOpen:Z,onClose:Q}=(0,em.j)();I[4]!==M||I[5]!==B?(n={onSuccess:()=>{M&&(B.getStructureList.invalidate({screenId:M}),B.getActiveStructure.invalidate({screenId:M}))}},I[4]=M,I[5]=B,I[6]=n):n=I[6];let G=z.i.deleteStructure.useMutation(n),[$,q]=(0,w.useState)(!1);I[7]!==O.id||I[8]!==B?(l={onMutate:async e=>{var t;await B.getLikeFeedback.cancel({structureId:O.id});let r=B.getLikeFeedback.getData({structureId:O.id});return B.getLikeFeedback.setData({structureId:O.id},{structureId:e.structureId,like:e.like,createdAt:null!=(t=null==r?void 0:r.createdAt)?t:new Date,updatedAt:new Date}),{previousData:r}},onError:(e,t,r)=>{(null==r?void 0:r.previousData)&&B.getLikeFeedback.setData({structureId:O.id},r.previousData)}},I[7]=O.id,I[8]=B,I[9]=l):l=I[9];let K=z.i.addLikeFeedback.useMutation(l);if(I[10]!==O.createdAt){var X;X=O.createdAt,o=eu()(X).format("h:mm a"),I[10]=O.createdAt,I[11]=o}else o=I[11];s=o,I[12]!==M||I[13]!==O.id||I[14]!==O.screenName||I[15]!==F||I[16]!==(null==V?void 0:V.text)?(a=()=>{k.A.logEvent("[Versions] click",{chatId:M,structureId:O.id,screenName:O.screenName,prompt:null==V?void 0:V.text}),F(O.id)},I[12]=M,I[13]=O.id,I[14]=O.screenName,I[15]=F,I[16]=null==V?void 0:V.text,I[17]=a):a=I[17];let J=a;I[18]!==J?(i=e=>{e.defaultPrevented||J()},I[18]=J,I[19]=i):i=I[19];let ee=i;I[20]!==K||I[21]!==M||I[22]!==T||I[23]!==O.id||I[24]!==O.screenName||I[25]!==(null==V?void 0:V.text)?(c=(e,t)=>{e.preventDefault(),k.A.logEvent("[Versions] feedback",{chatId:M,structureId:O.id,screenName:O.screenName,prompt:null==V?void 0:V.text,like:t,flowId:T}),K.mutate({structureId:O.id,like:t})},I[20]=K,I[21]=M,I[22]=T,I[23]=O.id,I[24]=O.screenName,I[25]=null==V?void 0:V.text,I[26]=c):c=I[26];let et=c;I[27]!==G||I[28]!==O.id||I[29]!==Q?(d=async()=>{try{await G.mutateAsync({structureId:O.id}),Q()}catch(e){console.error("Error deleting structure:",e)}},I[27]=G,I[28]=O.id,I[29]=Q,I[30]=d):d=I[30];let er=d;I[31]!==O.id||I[32]!==D||I[33]!==P?(u=e=>{D(O.id,e.currentTarget),U(!0),P(!0)},I[31]=O.id,I[32]=D,I[33]=P,I[34]=u):u=I[34],I[35]!==P?(m=()=>{U(!1),P(!1)},I[35]=P,I[36]=m):m=I[36],I[37]!==J?(p=e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),J())},I[37]=J,I[38]=p):p=I[38];let en=O.id,es="Version from ".concat(s).concat(A?" (active)":""),ea=A&&"rounded-lg bg-secondary";I[39]!==ea?(h=(0,el.cn)("flow-row flex cursor-pointer justify-between py-0.5 pl-8 pr-1 text-sm font-medium leading-snug text-black",ea),I[39]=ea,I[40]=h):h=I[40];let ei=!A&&"opacity-60";I[41]!==ei?(x=(0,el.cn)("flex items-center gap-1",ei),I[41]=ei,I[42]=x):x=I[42],I[43]===Symbol.for("react.memo_cache_sentinel")?(f=(0,v.jsx)(ef,{"aria-hidden":"true"}),I[43]=f):f=I[43],I[44]!==s?(g=(0,v.jsx)("div",{className:"truncate",children:s}),I[44]=s,I[45]=g):g=I[45],I[46]!==x||I[47]!==g?(y=(0,v.jsxs)("div",{className:x,children:[f,g]}),I[46]=x,I[47]=g,I[48]=y):y=I[48];let ec=A?"opacity-40":"opacity-30";return I[49]!==ec?(j=(0,el.cn)("flex items-center gap-0.5",ec),I[49]=ec,I[50]=j):j=I[50],I[51]!==s||I[52]!==et||I[53]!==Y||I[54]!==(null==H?void 0:H.like)?(N=Y&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{onClick:e=>{et(e,!0)},className:"rounded p-0.5 hover:opacity-75 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Like version from ".concat(s),"aria-pressed":(null==H?void 0:H.like)===!0,children:(0,v.jsx)("img",{src:(null==H?void 0:H.like)===!0?"/thumbs-up-filled.svg":"/thumbs-up-empty.svg",alt:"","aria-hidden":"true",width:20,height:20})}),(0,v.jsx)("button",{onClick:e=>{et(e,!1)},className:"rounded p-0.5 hover:opacity-75 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Dislike version from ".concat(s),"aria-pressed":(null==H?void 0:H.like)===!1,children:(0,v.jsx)("img",{src:(null==H?void 0:H.like)===!1?"/thumbs-down-filled.svg":"/thumbs-down-empty.svg",alt:"","aria-hidden":"true",width:20,height:20})})]}),I[51]=s,I[52]=et,I[53]=Y,I[54]=null==H?void 0:H.like,I[55]=N):N=I[55],I[56]!==$||I[57]!==Y||I[58]!==Z?(C=(Y||$)&&(0,v.jsxs)(eo.rI,{open:$,onOpenChange:q,children:[(0,v.jsx)(eo.ty,{asChild:!0,children:(0,v.jsx)("div",{className:"relative cursor-pointer",children:(0,v.jsx)(eg.A,{"aria-label":"Version options",className:"cursor-pointer"})})}),(0,v.jsx)(eo.SQ,{sideOffset:-8,children:(0,v.jsx)(eo._2,{onSelect:Z,children:"Delete"})})]}),I[56]=$,I[57]=Y,I[58]=Z,I[59]=C):C=I[59],I[60]!==j||I[61]!==N||I[62]!==C?(E=(0,v.jsx)("div",{className:"relative flex items-center",children:(0,v.jsxs)("div",{className:j,children:[N,C]})}),I[60]=j,I[61]=N,I[62]=C,I[63]=E):E=I[63],I[64]!==ee||I[65]!==A||I[66]!==O.id||I[67]!==u||I[68]!==m||I[69]!==p||I[70]!==es||I[71]!==h||I[72]!==y||I[73]!==E?(L=(0,v.jsxs)("div",{onMouseEnter:u,onMouseLeave:m,onClick:ee,onKeyDown:p,role:"button",tabIndex:0,"aria-label":es,"aria-pressed":A,className:h,children:[y,E]},en),I[64]=ee,I[65]=A,I[66]=O.id,I[67]=u,I[68]=m,I[69]=p,I[70]=es,I[71]=h,I[72]=y,I[73]=E,I[74]=L):L=I[74],I[75]!==er||I[76]!==W||I[77]!==Q?(_=(0,v.jsx)(ew,{isOpen:W,onClose:Q,onDelete:er}),I[75]=er,I[76]=W,I[77]=Q,I[78]=_):_=I[78],I[79]!==R||I[80]!==L||I[81]!==_?(S=(0,v.jsxs)("li",{ref:R,className:"relative mb-1",children:[L,_]}),I[79]=R,I[80]=L,I[81]=_,I[82]=S):S=I[82],S}),ew=e=>{let t,r,n,l,s=(0,b.c)(11),{isOpen:o,onClose:a,onDelete:i}=e;return s[0]!==o||s[1]!==a||s[2]!==i?(t=()=>{let e=e=>{let t=document.activeElement;(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||(null==t?void 0:t.hasAttribute("contenteditable")))||"Escape"===e.key)&&o&&("Enter"===e.key&&i(),"Escape"===e.key&&a())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},r=[o,i,a],s[0]=o,s[1]=a,s[2]=i,s[3]=t,s[4]=r):(t=s[3],r=s[4]),(0,w.useEffect)(t,r),s[5]!==i?(n=(0,v.jsx)(K.g,{className:"rounded-2xl p-4",children:e=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"mb-1 flex flex-col gap-1 text-sm font-semibold leading-6",children:"Delete version"}),(0,v.jsx)("div",{className:"mb-4 flex flex-col gap-1 text-sm font-normal leading-6",children:"You are about to delete the selected version. You sure about this?"}),(0,v.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,v.jsx)("div",{onClick:()=>{i()},className:"flex h-10 cursor-pointer items-center justify-center rounded-xl bg-[#FF3366] text-center text-sm font-medium text-white",children:"Delete"}),(0,v.jsx)("div",{onClick:e,className:"flex h-10 cursor-pointer items-center justify-center rounded-xl bg-muted text-center text-sm font-medium text-black",children:"Close"})]})]})}),s[5]=i,s[6]=n):n=s[6],s[7]!==o||s[8]!==a||s[9]!==n?(l=(0,v.jsx)(X.Y,{backdrop:"opaque",isOpen:o,onClose:a,className:"w-70 bg-white text-black",hideCloseButton:!0,children:n}),s[7]=o,s[8]=a,s[9]=n,s[10]=l):l=s[10],l},ej=e=>{let{flowId:t}=e,r=(0,y.p)(),[n,l]=w.useState(!1),{hoveredItemRect:s,handleItemHover:o,handlePopupHover:a,setIsHoveringItem:i}=(()=>{let e,t,r,n,l,s=(0,b.c)(8),[o,a]=(0,w.useState)(!1),[i,c]=(0,w.useState)(!1),[d,u]=(0,w.useState)(null);s[0]!==o||s[1]!==i?(e=()=>{let e=setTimeout(()=>{o||i||u(null)},100);return()=>clearTimeout(e)},t=[o,i],s[0]=o,s[1]=i,s[2]=e,s[3]=t):(e=s[2],t=s[3]),(0,w.useEffect)(e,t),s[4]===Symbol.for("react.memo_cache_sentinel")?(r=e=>{u(e),a(!!e)},s[4]=r):r=s[4];let m=r;s[5]===Symbol.for("react.memo_cache_sentinel")?(n=e=>{c(e)},s[5]=n):n=s[5];let p=n;return s[6]!==d?(l={hoveredItemRect:d,handleItemHover:m,handlePopupHover:p,setIsHoveringItem:a},s[6]=d,s[7]=l):l=s[7],l})(),{data:c,isLoading:d}=z.i.getStructureList.useQuery({screenId:null!=r?r:""},{enabled:null!==r}),u=(0,eh.P)(r),m=null==u?void 0:u.id,p=(0,_.T)(r),h=z.i.useUtils(),x=w.useRef(null),f=w.useRef(null),g=w.useRef(!1),j=z.i.setActiveStructure.useMutation({onSuccess:async e=>{let{flowId:t,screenId:r}=e;await h.getActiveStructure.invalidate({screenId:r}),t&&await h.getFlow.invalidate({flowId:t})},onError:e=>{console.error("Error setting active structure:",e)}}),{handleSetStructureId:k,handleClearStructureId:N,previousMessage:C}=(0,eh.k)();w.useEffect(()=>{s||N()},[s,N]);let E=(0,w.useCallback)(e=>e===m,[m]),L=w.useMemo(()=>c&&(e=>{if(!e||!e.length)return[];let t=eu()().startOf("day"),r=t.valueOf(),n=eu()().subtract(1,"days").startOf("day"),l=n.valueOf(),s=[],o=[],a=[],i={};return e.forEach(e=>{let t=eu()(e.createdAt).startOf("day"),n=t.valueOf();if(n===r)o.push(e);else if(n===l)a.push(e);else{let r=t.format("YYYY-MM-DD");r in i||(i[r]=[]),i[r].push(e)}}),o.length>0&&s.push({date:t.format("YYYY-MM-DD"),title:null,items:o}),a.length>0&&s.push({date:n.format("YYYY-MM-DD"),title:"Yesterday",items:a}),Object.keys(i).sort((e,t)=>eu()(t,"YYYY-MM-DD").valueOf()-eu()(e,"YYYY-MM-DD").valueOf()).forEach(e=>{s.push({date:e,title:eu()(e,"YYYY-MM-DD").format("MMM D"),items:i[e]})}),s})(c),[c]),S=(0,w.useCallback)(async e=>{try{if(p||E(e))return;await j.mutateAsync({structureId:e})}catch(e){console.error("Error selecting version:",e),ep.Cp(e)}},[p,j,E]),I=(0,w.useCallback)((e,t)=>{k(e),o(t.getBoundingClientRect())},[k,o]);return(w.useEffect(()=>{if(x.current&&f.current&&c&&!g.current){g.current=!0;let e=setTimeout(()=>{var e;null==(e=x.current)||e.scrollIntoView({behavior:"smooth",block:"center"})},300);return()=>clearTimeout(e)}},[m,c]),!d&&(null==c?void 0:c.length))?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"relative flex flex-col",children:(0,v.jsx)("ol",{ref:f,className:(0,el.cn)("relative flex flex-col pt-1",c.length>4&&"max-h-[148px] overflow-y-auto scrollbar-hide"),children:L&&L.map(e=>(0,v.jsxs)(w.Fragment,{children:[e.title&&(0,v.jsx)("div",{className:"mb-1 px-8 py-0.5 text-sm font-medium leading-6 text-black opacity-40",children:e.title}),e.items.map(e=>(0,v.jsx)(ey,{item:e,isActive:E(e.id),chatId:r,flowId:t,onSelect:e=>void S(e),onSetStructureId:I,setIsHoveringItem:i,itemRef:E(e.id)?x:void 0},e.id))]},e.date))})}),C&&s&&1?(0,ec.createPortal)((0,v.jsx)("div",{style:{position:"fixed",left:"".concat(s.right,"px"),top:"".concat(s.top,"px"),pointerEvents:"auto",paddingLeft:"15px"},onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),role:"tooltip","aria-label":"Version prompt details",children:(0,v.jsxs)("div",{className:"shadow-ui-lg group -my-1 flex max-h-[200px] min-h-[50px] w-[248px] flex-col gap-0 overflow-auto rounded-xl bg-white px-3 py-2 text-black",children:[(0,v.jsxs)("div",{className:"flex items-start justify-between",children:[(0,v.jsx)("div",{className:"flex-1 pr-2 text-sm font-semibold leading-6",children:"Prompt"}),(0,v.jsx)("div",{className:"flex h-[24px] flex-shrink-0 items-center",children:(0,v.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(C),l(!0),setTimeout(()=>{l(!1)},2e3)},className:"hidden items-center gap-0 rounded p-1 text-sm font-semibold leading-6 opacity-50 hover:opacity-75 group-hover:flex",title:"Copy prompt","aria-label":n?"Copied":"Copy prompt to clipboard",children:[!n&&(0,v.jsx)(eb,{width:20,height:20,className:"filter-black","aria-hidden":"true"}),n?"Copied":"Copy"]})})]}),(0,v.jsx)("div",{className:"whitespace-pre-line text-sm font-normal leading-6",children:C})]})}),document.body):null]}):null};function ek(){return(ek=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let eN=function(e){return w.createElement("svg",ek({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a||(a=w.createElement("path",{d:"M8 10V8H10",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),i||(i=w.createElement("path",{d:"M16 10V8H14",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),c||(c=w.createElement("path",{d:"M16 14V16H14",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),d||(d=w.createElement("path",{d:"M8 14V16H10",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};function eC(){return(eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let eE=function(e){return w.createElement("svg",eC({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),u||(u=w.createElement("path",{d:"M9 9V15M9 9V7M9 9H7M9 15H15M9 15H7M9 15V17M15 15H17M15 15V17M15 15V15",stroke:"#000000",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),m||(m=w.createElement("path",{d:"M14.7857 8.78571L15 7L15.2143 8.78571L17 9L15.2143 9.21429L15 11L14.7857 9.21429L13 9L14.7857 8.78571Z",fill:"#000000",stroke:"#000000",strokeWidth:2,strokeLinejoin:"round"})))};function eL(){return(eL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let e_=function(e){return w.createElement("svg",eL({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),p||(p=w.createElement("path",{d:"M16 12H8M12 8V16",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};var eS=r(85665),eI=r(90214);let eM=(0,w.memo)(e=>{let t,r,n,l,s,o,a,i,c,d,u,m,p,h,x,f,g,y,j,k,N,C=(0,b.c)(68),{id:E,index:L,onClick:S,onExportScreen:I,duplicateChat:M,flowId:O}=e;C[0]!==E?(t={id:E},C[0]=E,C[1]=t):t=C[1];let{attributes:A,listeners:F,setNodeRef:D,transform:T,transition:P,isDragging:R}=(0,en.gl)(t),V=(0,eS.a)(E),Y=(0,w.useContext)(Q.U),[U,B]=(0,w.useState)(!1),[H,W]=(0,w.useState)(!1);C[2]!==T||C[3]!==P?(r=T?{transform:"translate3d(".concat(T.x,"px, ").concat(T.y,"px, 0)"),transition:P}:void 0,C[2]=T,C[3]=P,C[4]=r):r=C[4];let Z=r;C[5]!==R||C[6]!==S?(n=()=>{R||S()},C[5]=R,C[6]=S,C[7]=n):n=C[7];let z=n,G=(0,_.T)(E);C[8]!==G?(l=G&&{backgroundColor:"color-mix(in srgb, var(--ai-thinking) 20%, transparent)"},C[8]=G,C[9]=l):l=C[9],C[10]!==Z||C[11]!==l?(s={...Z,...l},C[10]=Z,C[11]=l,C[12]=s):s=C[12];let $=R?"cursor-move":"cursor-pointer",q=V&&"overflow-hidden bg-secondary",K=!V&&!G&&"hover:bg-[color-mix(in_srgb,var(--primary-hex)_10%,transparent)]",X=G&&"animate-pulse";C[13]!==$||C[14]!==q||C[15]!==K||C[16]!==X?(o=(0,el.cn)("group relative mb-1 flex flex-col rounded-lg",$,q,K,X),C[13]=$,C[14]=q,C[15]=K,C[16]=X,C[17]=o):o=C[17],C[18]===Symbol.for("react.memo_cache_sentinel")?(a=(0,el.cn)("relative flex h-8 flex-row items-center gap-1 rounded-lg px-1"),C[18]=a):a=C[18],C[19]!==V||C[20]!==G?(i=G?(0,v.jsx)(eE,{className:"cursor-pointer text-black opacity-100"}):(0,v.jsx)(eN,{className:(0,el.cn)("cursor-pointer text-black transition-opacity",V?"opacity-100":"opacity-50 group-hover:opacity-100")}),C[19]=V,C[20]=G,C[21]=i):i=C[21];let J=V?"opacity-100":"opacity-50 group-hover:opacity-100";C[22]!==J?(c=(0,el.cn)("w-9/12 overflow-scroll text-nowrap text-sm font-medium leading-snug text-black transition-opacity scrollbar-hide",J),C[22]=J,C[23]=c):c=C[23],C[24]!==E||C[25]!==L||C[26]!==U||C[27]!==c?(d=(0,v.jsx)(es.e,{chatId:E,isEditable:U,setIsEditable:B,className:c,screenCount:L}),C[24]=E,C[25]=L,C[26]=U,C[27]=c,C[28]=d):d=C[28];let ee=H||V?"opacity-60":"opacity-0 group-hover:opacity-60";return C[29]!==ee?(u=(0,el.cn)("cursor-pointer transition-opacity",ee),C[29]=ee,C[30]=u):u=C[30],C[31]!==u?(m=(0,v.jsx)(eo.ty,{asChild:!0,children:(0,v.jsx)("div",{className:"relative ml-auto",children:(0,v.jsx)(eg.A,{"aria-label":"Screen options",className:u})})}),C[31]=u,C[32]=m):m=C[32],C[33]!==Y.readonly?(p=!Y.readonly&&(0,v.jsx)(eo._2,{onSelect:e=>{e.preventDefault(),W(!1),B(!0)},children:"Rename"}),C[33]=Y.readonly,C[34]=p):p=C[34],C[35]!==M||C[36]!==E?(h=(0,v.jsx)(eo._2,{onClick:e=>{e.preventDefault(),W(!1),M(E)},children:"Duplicate"}),C[35]=M,C[36]=E,C[37]=h):h=C[37],C[38]!==E||C[39]!==I?(x=(0,v.jsx)(eo._2,{onClick:e=>{e.preventDefault(),W(!1),I(E)},children:"Export"}),C[38]=E,C[39]=I,C[40]=x):x=C[40],C[41]!==E?(f=(0,v.jsx)(eo._2,{onClick:e=>{e.preventDefault(),W(!1);let t=document.getElementById(E);if(t){let e=new CustomEvent("delete-screen",{detail:{chatId:E}});t.dispatchEvent(e)}},children:"Delete"}),C[41]=E,C[42]=f):f=C[42],C[43]!==p||C[44]!==h||C[45]!==x||C[46]!==f?(g=(0,v.jsxs)(eo.SQ,{sideOffset:-8,children:[p,h,x,f]}),C[43]=p,C[44]=h,C[45]=x,C[46]=f,C[47]=g):g=C[47],C[48]!==H||C[49]!==m||C[50]!==g?(y=(0,v.jsxs)(eo.rI,{open:H,onOpenChange:W,children:[m,g]}),C[48]=H,C[49]=m,C[50]=g,C[51]=y):y=C[51],C[52]!==i||C[53]!==d||C[54]!==y?(j=(0,v.jsxs)("div",{className:a,children:[i,d,y]}),C[52]=i,C[53]=d,C[54]=y,C[55]=j):j=C[55],C[56]!==O||C[57]!==V?(k=V&&(0,v.jsx)("div",{className:"",children:(0,v.jsx)(ej,{flowId:O})}),C[56]=O,C[57]=V,C[58]=k):k=C[58],C[59]!==A||C[60]!==z||C[61]!==F||C[62]!==D||C[63]!==o||C[64]!==j||C[65]!==k||C[66]!==s?(N=(0,v.jsxs)("div",{ref:D,style:s,...A,...F,onClick:z,className:o,children:[j,k]}),C[59]=A,C[60]=z,C[61]=F,C[62]=D,C[63]=o,C[64]=j,C[65]=k,C[66]=s,C[67]=N):N=C[67],N}),eO=(0,w.memo)(e=>{let t,r,n,l,s,o,a,i,c,d,u,m,p,h,x,f,g,y,j,N,C,E,L=(0,b.c)(49),{flowId:_,onChatAdd:S,onExportScreen:I}=e,M=(0,eI.d)();L[0]!==_?(t={flowId:_},L[0]=_,L[1]=t):t=L[1];let O=z.i.getFlowScreens.useQuery(t).data;L[2]!==O?(n=null==O?void 0:O.map(eA),L[2]=O,L[3]=n):n=L[3],r=n;let A=(0,R.TI)(),F=(0,R.iW)();L[4]===Symbol.for("react.memo_cache_sentinel")?(l=[],L[4]=l):l=L[4];let[D,T]=w.useState(l);L[5]===Symbol.for("react.memo_cache_sentinel")?(s={activationConstraint:{delay:150,tolerance:5}},L[5]=s):s=L[5],L[6]===Symbol.for("react.memo_cache_sentinel")?(o={activationConstraint:{delay:150,tolerance:5}},L[6]=o):o=L[6];let P=(0,et.FR)((0,et.MS)(et.cA,s),(0,et.MS)(et.IG,o));L[7]!==r?(a=()=>{r&&T(r)},i=[r],L[7]=r,L[8]=a,L[9]=i):(a=L[8],i=L[9]),w.useEffect(a,i),L[10]!==_||L[11]!==A||L[12]!==D?(c=e=>{let{active:t,over:r}=e;if(r&&t.id!==r.id){let e=D.indexOf(t.id),n=D.indexOf(r.id),l=(0,en.be)(D,e,n);T(l),A.mutate({flowId:_,screenIds:l})}},L[10]=_,L[11]=A,L[12]=D,L[13]=c):c=L[13];let V=c,{fitViewToChat:Y}=(0,ei.k)();L[14]!==Y||L[15]!==M?(d=e=>{Y(e),M(e)},L[14]=Y,L[15]=M,L[16]=d):d=L[16];let U=d;L[17]!==F?(u=e=>{k.A.logEvent("[Flow] screen duplicate",{source:"sidebar"}),ea.oR.promise(F.mutateAsync({screenId:e}),{loading:"Duplicating screen...",success:"Screen duplicated successfully",error:"Error duplicating screen, try again"})},L[17]=F,L[18]=u):u=L[18];let B=u;if(L[19]===Symbol.for("react.memo_cache_sentinel")?(m=(0,v.jsx)("div",{className:"h-2"}),L[19]=m):m=L[19],L[20]===Symbol.for("react.memo_cache_sentinel")?(p=[er.FN,er.gj],L[20]=p):p=L[20],L[21]!==_||L[22]!==B||L[23]!==U||L[24]!==I||L[25]!==D){let e;L[27]!==_||L[28]!==B||L[29]!==U||L[30]!==I?(e=(e,t)=>(0,v.jsx)(eM,{id:e,index:t,onClick:()=>{U(e)},onExportScreen:I,duplicateChat:B,flowId:_},e),L[27]=_,L[28]=B,L[29]=U,L[30]=I,L[31]=e):e=L[31],h=D.map(e),L[21]=_,L[22]=B,L[23]=U,L[24]=I,L[25]=D,L[26]=h}else h=L[26];return L[32]!==h||L[33]!==D?(x=(0,v.jsx)(en.gB,{items:D,strategy:en._G,children:h}),L[32]=h,L[33]=D,L[34]=x):x=L[34],L[35]!==V||L[36]!==P||L[37]!==x?(f=(0,v.jsx)(et.Mp,{sensors:P,collisionDetection:et.fp,onDragEnd:V,modifiers:p,children:x}),L[35]=V,L[36]=P,L[37]=x,L[38]=f):f=L[38],L[39]===Symbol.for("react.memo_cache_sentinel")?(g=(0,el.cn)("group relative mb-1 flex h-8 w-full cursor-pointer items-center gap-1 rounded-lg px-1 text-sm font-medium leading-snug text-black hover:bg-[color-mix(in_srgb,var(--primary-hex)_10%,transparent)]"),L[39]=g):g=L[39],L[40]!==S?(y=e=>{e.preventDefault(),S()},L[40]=S,L[41]=y):y=L[41],L[42]===Symbol.for("react.memo_cache_sentinel")?(j=(0,v.jsx)(e_,{className:"h-6 w-6 opacity-50 group-hover:opacity-100"}),N=(0,v.jsx)("span",{className:"opacity-50 group-hover:opacity-100",children:"New Screen"}),L[42]=j,L[43]=N):(j=L[42],N=L[43]),L[44]!==y?(C=(0,v.jsxs)("button",{className:g,onClick:y,children:[j,N]}),L[44]=y,L[45]=C):C=L[45],L[46]!==f||L[47]!==C?(E=(0,v.jsx)("div",{className:"flex min-h-0 flex-1 flex-col overflow-hidden",children:(0,v.jsxs)("div",{className:"max-h-full flex-grow overflow-y-auto overflow-x-hidden pb-[4px] scrollbar-hide",children:[m,f,C]})}),L[46]=f,L[47]=C,L[48]=E):E=L[48],E});function eA(e){return e.id}var eF=r(80095),eD=r.n(eF),eT=r(38637);let eP=()=>{let e,t=(0,b.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,v.jsx)("div",{className:"h-px w-full",style:{backgroundColor:"#e0e0e0"}}),t[0]=e):e=t[0],e},eR=e=>{let t,r,n,l,s,o,a=(0,b.c)(14),{flowId:i,flowName:c}=e,{isOpen:d,onOpen:u,onClose:m}=(0,em.j)();return a[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,v.jsx)(eD(),{href:"/flow","aria-label":"Go Home",children:(0,v.jsx)("img",{src:"/toHome.svg",className:"cursor-pointer"})}),a[0]=t):t=a[0],a[1]!==c||a[2]!==u?(r=c&&(0,v.jsx)("div",{className:"text-sm font-semibold text-black",onDoubleClick:u,children:c}),a[1]=c,a[2]=u,a[3]=r):r=a[3],a[4]!==i||a[5]!==d||a[6]!==m?(n=(0,v.jsx)(eT.h,{flowId:i,isOpen:d,onClose:m}),a[4]=i,a[5]=d,a[6]=m,a[7]=n):n=a[7],a[8]!==r||a[9]!==n?(l=(0,v.jsxs)("div",{className:"flex flex-col gap-2 px-4 pb-3 pt-4",children:[t,r,n]}),a[8]=r,a[9]=n,a[10]=l):l=a[10],a[11]===Symbol.for("react.memo_cache_sentinel")?(s=(0,v.jsx)(eP,{}),a[11]=s):s=a[11],a[12]!==l?(o=(0,v.jsxs)(v.Fragment,{children:[l,s]}),a[12]=l,a[13]=o):o=a[13],o};var eV=r(50965),eY=r(17476),eU=r.n(eY),eB=r(90278),eH=r(68546);let eW=e=>{let{flowId:t,chatIds:r,isVisible:n,onClose:l,initialSelectedScreens:s}=e,[o,a]=(0,w.useState)("png"),[i,c]=(0,w.useState)([]),[d,u]=(0,w.useState)(!1),m=(0,y.p)(),p=(0,eI.d)(),h=(0,w.useRef)(!1),{data:x}=z.i.getScreensWithStructure.useQuery({screenIds:r}),{screenNames:f}={screenNames:new Map(z.i.useQueries(e=>r.map(t=>e.getScreen({screenId:t}))).map(e=>{let{data:t}=e;return t&&[t.id,t.screenName]}).filter(e=>void 0!==e))};(0,w.useEffect)(()=>{!h.current&&n&&void 0!==x&&(c(s&&s.length>0?s.filter(e=>x.includes(e)):[...x]),h.current=!0)},[h,n,x,s]),(0,w.useEffect)(()=>{h.current=!1},[n]);let g=e=>{c(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},b=()=>{x&&c(e=>e.length===x.length?[]:x)},j=()=>i.length===(null==x?void 0:x.length)&&x.length>0?"all":i.length>0?"some":"none",N=()=>new Promise(e=>{setTimeout(e,500)}),C=async()=>{try{if(u(!0),k.A.logEvent("[Export button] download multiple images",{flowId:t,ext:o,count:i.length}),1===i.length){let e,n=i[0];p(n),await N();let l=f.get(n)||"Screen ".concat(r.indexOf(n)+1);try{e=(await (0,eH.b)({format:o,pixelRatio:3,quality:1})).dataUrl}catch(e){throw console.error("Error getting image:",e),ea.oR.error("Error exporting ".concat(l)),e}if(e){let t=await fetch(e),r=await t.blob(),n=document.createElement("a");n.download="".concat(l.replace(/[^\w-]/g,""),".").concat(o),n.href=URL.createObjectURL(r),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(n.href)}p(m),k.A.logEvent("[Export button] export success",{flowId:t,ext:o,count:1}),u(!1);return}let e=new(eU());for(let t of i){let n;p(t),await N();let l=f.get(t)||"Screen ".concat(r.indexOf(t)+1);try{n=(await (0,eH.b)({format:o})).dataUrl}catch(e){ep.Cp(e),ea.oR.error("Error exporting "+l);continue}let s=l.replace(/[^\w-]/g,""),a=await fetch(n),i=await a.blob();e.file("".concat(s,".").concat(o),i)}p(m);let n=Object.keys(e.files).length;if(0===n)throw Error("No screens could be exported.");let l=await e.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6},platform:"DOS"}),s=document.createElement("a");s.download="banani-ui-export.zip",s.href=URL.createObjectURL(l),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(s.href),k.A.logEvent("[Export button] export success",{flowId:t,ext:o,count:i.length})}catch(e){ep.Cp(e),k.A.logEvent("[Export button] export error",{flowId:t,ext:o,error:String(e)})}finally{u(!1)}};return(0,v.jsx)(eV.N,{children:n&&(0,v.jsx)(X.Y,{hideCloseButton:!0,isOpen:n,onClose:l,backdrop:"opaque",placement:"center",classNames:{base:"bg-white drop-shadow-lg rounded-[16px] shadow-2xl w-[280px] p-[16px] max-h-[40vh]"},motionProps:{variants:{enter:{opacity:1,scale:1,y:0,transition:{duration:.1,ease:[.16,1,.3,1]}},exit:{opacity:0,scale:.95,y:-2,transition:{duration:.1,ease:[.16,1,.3,1]}}}},children:(0,v.jsxs)(K.g,{className:"h-full rounded-[18px]",children:[(0,v.jsxs)("div",{className:"flex flex-col gap-[8px]",children:[(0,v.jsx)("div",{className:"text-[14px] font-semibold text-black",children:"Export as"}),(0,v.jsx)("div",{className:"mb-[20px]",children:(0,v.jsxs)("div",{className:"flex gap-[4px] rounded-[12px] bg-[#EBEBEB] p-[4px]",children:[(0,v.jsx)("button",{onClick:()=>{a("png")},className:(0,el.cn)("flex-1 rounded-[8px] px-[8px] py-[6px] text-[14px] font-medium transition-colors","png"===o?"bg-primary text-white":"text-black hover:bg-white/50"),children:"PNG"}),(0,v.jsx)("button",{onClick:()=>{a("jpeg")},className:(0,el.cn)("flex-1 rounded-[8px] px-[8px] py-[6px] text-[14px] font-medium transition-colors","jpeg"===o?"bg-primary text-white":"text-black hover:bg-white/50"),children:"JPG"}),(0,v.jsx)("button",{onClick:()=>{a("svg")},className:(0,el.cn)("flex-1 rounded-[8px] px-[8px] py-[6px] text-[14px] font-medium transition-colors","svg"===o?"bg-primary text-white":"text-black hover:bg-white/50"),children:"SVG"})]})})]}),(0,v.jsxs)("div",{className:"relative flex h-full min-h-0 flex-col",children:[(0,v.jsxs)("div",{className:"mb-[8px] flex flex-shrink-0 items-center",children:[(0,v.jsxs)("div",{className:(0,el.cn)("mr-[8px] flex h-[20px] w-[20px] cursor-pointer items-center justify-center rounded-[6px]","all"===j()||"some"===j()?"bg-primary":"bg-border"),onClick:b,children:["all"===j()&&(0,v.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,v.jsx)("path",{d:"M10 3L4.5 8.5L2 6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"some"===j()&&(0,v.jsx)("div",{className:"h-[2px] w-[10px] rounded-full bg-white"})]}),(0,v.jsxs)("div",{className:"cursor-pointer select-none text-sm font-semibold text-black",onClick:b,children:[i.length," ",1===i.length?"screen":"screens"," selected"]})]}),(0,v.jsx)("div",{className:"h-[1px] flex-shrink-0 bg-border"}),(0,v.jsx)("div",{className:"min-h-0 flex-1 overflow-y-auto pb-[72px] pt-[8px] scrollbar-hide",children:void 0===x?(0,v.jsx)("div",{className:"py-4 text-center text-[14px] text-muted-foreground",children:"Loading screens..."}):0===r.length?(0,v.jsx)("div",{className:"py-4 text-center text-[14px] text-muted-foreground",children:"No screens found"}):r.map((e,t)=>{let r=f.get(e)||"Screen ".concat(t+1),n=x.includes(e),l=i.includes(e);return(0,v.jsxs)("div",{className:(0,el.cn)("mb-[8px] flex h-[24px] items-center",!n&&"opacity-50"),children:[(0,v.jsx)("div",{className:(0,el.cn)("mr-[8px] flex h-[20px] w-[20px] items-center justify-center rounded-[6px]",n?(0,el.cn)("cursor-pointer",l?"bg-primary":"bg-border"):"cursor-not-allowed bg-muted"),onClick:()=>{n&&g(e)},children:l&&n&&(0,v.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,v.jsx)("path",{d:"M10 3L4.5 8.5L2 6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,v.jsxs)("div",{className:(0,el.cn)("select-none text-sm font-medium",n?"cursor-pointer text-black":"cursor-not-allowed text-muted-foreground"),onClick:()=>{n&&g(e)},children:[r,!n&&(0,v.jsx)("span",{className:"ml-2 text-sm font-medium text-muted-foreground",children:"Empty"})]})]},e)})}),(0,v.jsx)("div",{className:"absolute bottom-0 left-0 right-0 z-10 bg-gradient-to-t from-white via-white/95 to-transparent pt-[16px]",children:(0,v.jsx)(eB.T,{disableRipple:!0,color:"primary",onClick:()=>void C(),isDisabled:void 0===x||0===i.length||0===x.length,isLoading:d,className:"h-[40px] w-full rounded-[12px] bg-primary text-[14px] font-medium text-white",children:d?"Exporting...":"Export"})})]})]})})})};var eZ=r(17855),ez=r(88571);let eQ=e=>{var t;let r,n,l,s,o,a,i,c,d,u,m,p=(0,b.c)(26),{flowId:h,handleAddChat:x}=e,f=(0,y.p)(),{flow:g}=(0,w.useContext)(ez.c);p[0]!==h?(r={flowId:h},p[0]=h,p[1]=r):r=p[1];let j=z.i.getFlowScreens.useQuery(r).data;p[2]!==j?(l=null==j?void 0:j.map(eG),p[2]=j,p[3]=l):l=p[3],n=l;let[N,C]=(0,w.useState)();p[4]!==f?(s=e=>{k.A.logEvent("[Flow] export screen from context menu",{chatId:f}),C(e)},p[4]=f,p[5]=s):s=p[5];let E=s;p[6]===Symbol.for("react.memo_cache_sentinel")?(o={fontFamily:"'Inter', sans-serif"},p[6]=o):o=p[6];let L=null!=(t=g.projectName)?t:"";return p[7]!==h||p[8]!==L?(a=(0,v.jsx)(eR,{flowId:h,flowName:L}),p[7]=h,p[8]=L,p[9]=a):a=p[9],p[10]!==h||p[11]!==x||p[12]!==E?(i=(0,v.jsx)("div",{id:"tour-screenlist",className:"flex min-h-0 flex-1 flex-col px-2",children:(0,v.jsx)(eO,{flowId:h,onChatAdd:x,onExportScreen:E})}),p[10]=h,p[11]=x,p[12]=E,p[13]=i):i=p[13],p[14]===Symbol.for("react.memo_cache_sentinel")?(c=(0,v.jsx)(eP,{}),p[14]=c):c=p[14],p[15]!==h?(d=(0,v.jsx)("div",{id:"tour-themes",className:"flex h-[40%] flex-shrink-0 flex-col px-2",children:(0,v.jsx)("div",{className:"h-full overflow-y-auto rounded-b-md scrollbar-hide",children:(0,v.jsx)(eZ.B,{flowId:h})})}),p[15]=h,p[16]=d):d=p[16],p[17]!==n||p[18]!==N||p[19]!==h?(u=n&&(0,v.jsx)(eW,{flowId:h,chatIds:n,isVisible:void 0!==N,onClose:()=>{C(void 0)},initialSelectedScreens:N?[N]:void 0}),p[17]=n,p[18]=N,p[19]=h,p[20]=u):u=p[20],p[21]!==d||p[22]!==u||p[23]!==a||p[24]!==i?(m=(0,v.jsxs)("div",{style:o,className:"shadow-ui-sm absolute inset-y-1 left-1 z-10 flex w-[256px] flex-col rounded-2xl bg-white",children:[a,i,c,d,u]}),p[21]=d,p[22]=u,p[23]=a,p[24]=i,p[25]=m):m=p[25],m};function eG(e){return e.id}var e$=r(94362),eq=r(31262),eK=r(26761);function eX(){return(eX=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let eJ=function(e){return w.createElement("svg",eX({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),h||(h=w.createElement("path",{d:"M5 14V16C5 17.6569 6.34315 19 8 19H16C17.6569 19 19 17.6569 19 16V14M11.9995 12V5M11.9995 5L9 8M11.9995 5L15 8.00048",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};function e1(){return(e1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let e0=function(e){return w.createElement("svg",e1({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),x||(x=w.createElement("path",{d:"M16.6629 7.33714L15.9558 8.04424L15.9558 8.04424L16.6629 7.33714ZM15.9558 13.0863C15.5652 13.4768 15.5652 14.11 15.9558 14.5005C16.3463 14.891 16.9794 14.891 17.37 14.5005L16.6629 13.7934L15.9558 13.0863ZM7.33714 16.6629L8.04424 15.9558L8.04424 15.9558L7.33714 16.6629ZM14.5005 17.37C14.891 16.9794 14.891 16.3463 14.5005 15.9558C14.11 15.5652 13.4768 15.5652 13.0863 15.9558L13.7934 16.6629L14.5005 17.37ZM8.04425 10.9137C8.43477 10.5232 8.43477 9.89001 8.04425 9.49948C7.65372 9.10896 7.02056 9.10896 6.63003 9.49948L7.33714 10.2066L8.04425 10.9137ZM9.49948 6.63003C9.10896 7.02056 9.10896 7.65372 9.49948 8.04424C9.89001 8.43477 10.5232 8.43477 10.9137 8.04425L10.2066 7.33714L9.49948 6.63003ZM14.1418 11.2724C14.5324 10.8819 14.5324 10.2487 14.1418 9.85817C13.7513 9.46764 13.1181 9.46764 12.7276 9.85817L13.4347 10.5653L14.1418 11.2724ZM9.85817 12.7276C9.46764 13.1181 9.46764 13.7513 9.85817 14.1418C10.2487 14.5324 10.8819 14.5324 11.2724 14.1418L10.5653 13.4347L9.85817 12.7276ZM16.6629 7.33714L15.9558 8.04424C17.3481 9.43657 17.3481 11.694 15.9558 13.0863L16.6629 13.7934L17.37 14.5005C19.5433 12.3271 19.5433 8.80341 17.37 6.63003L16.6629 7.33714ZM7.33714 16.6629L6.63003 17.37C8.80341 19.5433 12.3271 19.5433 14.5005 17.37L13.7934 16.6629L13.0863 15.9558C11.694 17.3481 9.43657 17.3481 8.04424 15.9558L7.33714 16.6629ZM7.33714 10.2066L6.63003 9.49948C4.45666 11.6729 4.45665 15.1966 6.63003 17.37L7.33714 16.6629L8.04424 15.9558C6.65192 14.5634 6.65192 12.306 8.04425 10.9137L7.33714 10.2066ZM10.2066 7.33714L10.9137 8.04425C12.306 6.65192 14.5634 6.65192 15.9558 8.04424L16.6629 7.33714L17.37 6.63003C15.1966 4.45666 11.6729 4.45666 9.49948 6.63003L10.2066 7.33714ZM13.4347 10.5653L12.7276 9.85817L9.85817 12.7276L10.5653 13.4347L11.2724 14.1418L14.1418 11.2724L13.4347 10.5653Z",fill:"currentColor"})))};function e2(){return(e2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let e4=function(e){return w.createElement("svg",e2({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),f||(f=w.createElement("path",{d:"M7 9.54722V14.4557C7 16.4167 7 17.3972 7.40831 17.9339C7.76395 18.4013 8.30709 18.6888 8.89362 18.72C9.567 18.7559 10.3778 18.2046 11.9994 17.1019L15.6086 14.6476C16.913 13.7607 17.5652 13.3172 17.7935 12.7608C17.9932 12.2743 17.9932 11.7287 17.7935 11.2421C17.5652 10.6858 16.913 10.2423 15.6086 9.3553L11.9994 6.90106C10.3778 5.79837 9.567 5.24703 8.89362 5.28289C8.30709 5.31414 7.76395 5.60162 7.40831 6.06907C7 6.60573 7 7.58623 7 9.54722Z",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};var e5=r(46676),e6=r(90084),e3=r(59222),e7=r(63610),e8=r(7513),e9=r(69450);function te(){return(te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let tt=function(e){return w.createElement("svg",te({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),g||(g=w.createElement("path",{d:"M13 17L12.375 15.5C11.5666 14.6282 10.7012 14 8.50001 14C6.29879 14 5.43337 14.6282 4.625 15.5L4 17M18 15V9M21 12H15M8.5 11C7.11929 11 6 9.88071 6 8.5C6 7.11929 7.11929 6 8.5 6C9.88071 6 11 7.11929 11 8.5C11 9.88071 9.88071 11 8.5 11Z",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))},tr=e=>{let t,r,n,l,s,o,a,i=(0,b.c)(24),{flowId:c}=e;i[0]!==c?(t={flowId:c},i[0]=c,i[1]=t):t=i[1];let d=z.i.getFlow.useQuery(t),u=z.i.getMyTeams.useQuery(),m=(0,R.ZA)();if(u.isError||d.isError)return null;if(u.isPending||d.isPending){let e;return i[2]===Symbol.for("react.memo_cache_sentinel")?(e=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(tl,{}),(0,v.jsx)(tl,{})]}),i[2]=e):e=i[2],e}i[3]!==d.data.teamId||i[4]!==c||i[5]!==m?(r=e=>{var t;let{value:r}=e.target,n="private"===r?null:r;k.A.logEvent("[Share] Workspace changed",{from:null!=(t=d.data.teamId)?t:"private",to:null!=n?n:"private"}),m.mutate({flowId:c,updates:{teamId:n}})},i[3]=d.data.teamId,i[4]=c,i[5]=m,i[6]=r):r=i[6];let p=r,h=null===d.data.teamId;if(i[7]===Symbol.for("react.memo_cache_sentinel")?(n=(0,v.jsx)(e3.A,{className:"size-6","aria-hidden":"true"}),i[7]=n):n=i[7],i[8]!==p||i[9]!==h?(l=(0,v.jsx)(tn,{checked:h,displayName:"Private",description:"Visible to you and anyone with the link",icon:n,value:"private",onChange:p}),i[8]=p,i[9]=h,i[10]=l):l=i[10],i[11]!==u.data.length?(s=0===u.data.length&&(0,v.jsx)(eD(),{href:"/upgrade-to-team",className:"rounded-lg bg-muted p-3 has-[:checked]:bg-[color:color-mix(in_srgb,rgb(var(--primary))_20%,transparent)]",onClick:ts,children:(0,v.jsxs)("div",{className:"flex items-start gap-2",children:[(0,v.jsx)(tt,{}),(0,v.jsxs)("div",{children:[(0,v.jsx)("span",{className:"font-semibold",children:"Create team"}),(0,v.jsx)("div",{className:"text-muted-foreground",children:"Set up a team for easy sharing"})]})]})}),i[11]=u.data.length,i[12]=s):s=i[12],i[13]!==d.data.teamId||i[14]!==p||i[15]!==u.data){let e;i[17]!==d.data.teamId||i[18]!==p?(e=e=>{var t,r;return(0,v.jsx)(tn,{checked:d.data.teamId===e.id,value:e.id,displayName:(null!=(r=null==(t=e.members.find(to))?void 0:t.user.email)?r:"someone")+"'s team",description:"Visible to team and anyone with the link",icon:(0,v.jsx)(e7.A,{className:"size-6","aria-hidden":"true"}),onChange:p},e.id)},i[17]=d.data.teamId,i[18]=p,i[19]=e):e=i[19],o=u.data.map(e),i[13]=d.data.teamId,i[14]=p,i[15]=u.data,i[16]=o}else o=i[16];return i[20]!==l||i[21]!==s||i[22]!==o?(a=(0,v.jsxs)("div",{className:"flex flex-col gap-2",children:[l,s,o]}),i[20]=l,i[21]=s,i[22]=o,i[23]=a):a=i[23],a},tn=e=>{let t,r,n,l,s,o,a,i,c=(0,b.c)(22),{value:d,displayName:u,checked:m,description:p,icon:h,onChange:x}=e;return c[0]!==u?(t=(0,v.jsx)("span",{className:"font-semibold",children:u}),c[0]=u,c[1]=t):t=c[1],c[2]!==p?(r=(0,v.jsx)("span",{className:"text-muted-foreground",children:p}),c[2]=p,c[3]=r):r=c[3],c[4]!==t||c[5]!==r?(n=(0,v.jsxs)("div",{className:"flex flex-col gap-0.5",children:[t,r]}),c[4]=t,c[5]=r,c[6]=n):n=c[6],c[7]!==h||c[8]!==n?(l=(0,v.jsxs)("div",{className:"flex items-start gap-1.5",children:[h,n]}),c[7]=h,c[8]=n,c[9]=l):l=c[9],c[10]!==m?(s=m&&(0,v.jsx)(e8.A,{className:"h-4 w-4 flex-shrink-0"}),c[10]=m,c[11]=s):s=c[11],c[12]!==l||c[13]!==s?(o=(0,v.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[l,s]}),c[12]=l,c[13]=s,c[14]=o):o=c[14],c[15]!==m||c[16]!==x||c[17]!==d?(a=(0,v.jsx)("input",{className:"hidden",type:"radio",name:"workspace",value:d,checked:m,onChange:x}),c[15]=m,c[16]=x,c[17]=d,c[18]=a):a=c[18],c[19]!==o||c[20]!==a?(i=(0,v.jsxs)("label",{className:"cursor-pointer rounded-lg bg-muted p-3 has-[:checked]:bg-[color:color-mix(in_srgb,rgb(var(--primary))_20%,transparent)]",children:[o,a]}),c[19]=o,c[20]=a,c[21]=i):i=c[21],i},tl=()=>{let e,t,r=(0,b.c)(2);return r[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,v.jsx)(e9.E,{className:"size-6 rounded-full"}),r[0]=e):e=r[0],r[1]===Symbol.for("react.memo_cache_sentinel")?(t=(0,v.jsx)("div",{className:"rounded-lg border border-transparent p-2",children:(0,v.jsxs)("div",{className:"flex items-start gap-2",children:[e,(0,v.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,v.jsx)(e9.E,{className:"h-4 w-24"}),(0,v.jsx)(e9.E,{className:"h-3 w-40 max-w-full"})]})]})}),r[1]=t):t=r[1],t};function ts(){k.A.logEvent("[Share] Create team clicked",{source:"workspace_selector"})}function to(e){return"owner"===e.role}var ta=r(12724),ti=r(74759);function tc(e){let t,r,n,l,s,o,a,i,c,d,u,m=(0,b.c)(21),{flowId:p,isPrototype:h}=e,x=void 0!==h&&h,f=(0,N.useRouter)();return m[0]===Symbol.for("react.memo_cache_sentinel")?(t={zIndex:11},r=(0,v.jsx)(e6.G,{}),m[0]=t,m[1]=r):(t=m[0],r=m[1]),m[2]!==p||m[3]!==f?(n=()=>{k.A.logEvent("[Play prototype] clicked"),f.push("/prototype/".concat(p))},m[2]=p,m[3]=f,m[4]=n):n=m[4],m[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,v.jsx)(e4,{}),m[5]=l):l=m[5],m[6]!==n?(s=(0,v.jsx)(e5.k$,{asChild:!0,children:(0,v.jsx)(W.$,{size:"sm",variant:"secondary",onClick:n,className:"flex h-8 items-center px-2",children:l})}),m[6]=n,m[7]=s):s=m[7],m[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,v.jsx)(e5.ZI,{children:"Play prototype"}),m[8]=o):o=m[8],m[9]!==s?(a=(0,v.jsxs)(e5.m_,{children:[s,o]}),m[9]=s,m[10]=a):a=m[10],m[11]!==p?(i=(0,v.jsx)(tm,{flowId:p}),m[11]=p,m[12]=i):i=m[12],m[13]===Symbol.for("react.memo_cache_sentinel")?(c=(0,v.jsx)(ti.zM,{asChild:!0,onClick:td,children:(0,v.jsxs)(W.$,{variant:"primary",size:"sm",className:"flex h-8 items-center gap-1 pr-2",children:["Share",(0,v.jsx)(eJ,{})]})}),m[13]=c):c=m[13],m[14]!==p||m[15]!==x?(d=(0,v.jsxs)(ti.lG,{children:[c,(0,v.jsx)(ti.Cf,{children:(0,v.jsx)(tu,{flowId:p,isPrototype:x})})]}),m[14]=p,m[15]=x,m[16]=d):d=m[16],m[17]!==d||m[18]!==a||m[19]!==i?(u=(0,v.jsxs)("div",{className:"relative flex items-center gap-2",style:t,children:[r,a,i,d]}),m[17]=d,m[18]=a,m[19]=i,m[20]=u):u=m[20],u}function td(){return k.A.logEvent("[Share button] clicked")}function tu(e){let t,r,n,l,s,o,a,i,c,d,u,m,p,h=(0,b.c)(24),{flowId:x,isPrototype:f}=e,[g,y]=(0,w.useState)(!1),j=window.location.origin+(f?"/prototype/":"/preview/")+x;h[0]!==j?(t=async()=>{try{k.A.logEvent("[Share button] link copied"),await navigator.clipboard.writeText(j),y(!0),setTimeout(()=>y(!1),2e3)}catch(e){console.error("Failed to copy text: ",e)}},h[0]=j,h[1]=t):t=h[1];let N=t;return h[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,v.jsx)("div",{className:"font-semibold text-black",children:"Share project"}),h[2]=r):r=h[2],h[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,v.jsxs)("div",{className:"flex flex-col gap-1",children:[r,(0,v.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Invite others to view your design"," ",(0,v.jsx)("a",{href:"https://intercom.help/banani/en/articles/11696109-share-your-design-with-others",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"learn more"})]})]}),l=(0,v.jsx)("hr",{className:"border-border"}),h[3]=n,h[4]=l):(n=h[3],l=h[4]),h[5]===Symbol.for("react.memo_cache_sentinel")?(s=(0,v.jsx)("div",{className:"text-sm font-semibold text-black",children:"Sharing link"}),h[5]=s):s=h[5],h[6]!==g||h[7]!==j?(o=g?(0,v.jsx)("span",{className:"text-green-400",children:"The link was copied to the clipboard"}):j,h[6]=g,h[7]=j,h[8]=o):o=h[8],h[9]!==o?(a=(0,v.jsxs)("div",{className:"flex min-w-0 flex-col gap-1",children:[s,(0,v.jsx)("div",{className:"min-w-0 overflow-hidden text-ellipsis text-nowrap text-sm text-muted-foreground",children:o})]}),h[9]=o,h[10]=a):a=h[10],h[11]!==N?(i=()=>void N(),h[11]=N,h[12]=i):i=h[12],h[13]===Symbol.for("react.memo_cache_sentinel")?(c=(0,v.jsx)(e0,{className:"h-6 w-6"}),h[13]=c):c=h[13],h[14]!==i?(d=(0,v.jsxs)(W.$,{variant:"primary",size:"sm",onClick:i,className:"flex w-full items-center justify-center",children:["Copy link ",c]}),h[14]=i,h[15]=d):d=h[15],h[16]!==d||h[17]!==a?(u=(0,v.jsxs)("div",{className:"flex min-w-0 flex-col gap-3",children:[a,d]}),h[16]=d,h[17]=a,h[18]=u):u=h[18],h[19]!==x?(m=ta.f&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("hr",{className:"border-border"}),(0,v.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,v.jsx)("div",{className:"text-sm font-semibold text-black",children:"View access"}),(0,v.jsx)(tr,{flowId:x})]})]}),h[19]=x,h[20]=m):m=h[20],h[21]!==u||h[22]!==m?(p=(0,v.jsxs)(v.Fragment,{children:[n,l,u,m]}),h[21]=u,h[22]=m,h[23]=p):p=h[23],p}function tm(e){let t,r,n,l,s,o,a=(0,b.c)(11),{flowId:i}=e;a[0]!==i?(t={flowId:i},a[0]=i,a[1]=t):t=a[1];let c=z.i.getFlowScreens.useQuery(t).data;a[2]!==c?(n=null==c?void 0:c.map(tp),a[2]=c,a[3]=n):n=a[3],r=n;let[d,u]=(0,w.useState)(!1);return a[4]===Symbol.for("react.memo_cache_sentinel")?(l=(0,v.jsx)(W.$,{size:"sm",variant:"secondary",onClick:()=>{k.A.logEvent("[Export button] clicked"),u(!0)},className:"h-8",children:"Export"}),a[4]=l):l=a[4],a[5]!==r||a[6]!==i||a[7]!==d?(s=r&&(0,v.jsx)(eW,{flowId:i,chatIds:r,isVisible:d,onClose:()=>{u(!1)}}),a[5]=r,a[6]=i,a[7]=d,a[8]=s):s=a[8],a[9]!==s?(o=(0,v.jsxs)(v.Fragment,{children:[l,s]}),a[9]=s,a[10]=o):o=a[10],o}function tp(e){return e.id}var th=r(81500),tx=r(20429),tf=r(34970),tg=r(69895);r(52516);let tv="hasSeenFlowTour",tb=[{element:"#tour-promptbox",popover:{title:"Step 1 of 4",description:"Tell Banani what to design. Add images, Figma links, or switch AI models.",side:"top",align:"center"}},{element:"#tour-screenlist",popover:{title:"Step 2 of 4",description:"Browse screens and  switch between versions.",side:"right",align:"start"}},{element:"#tour-themes",popover:{title:"Step 3 of 4",description:"Select a theme or customize the styles.",side:"right",align:"start"}},{element:"#tour-share",popover:{title:"Step 4 of 4",description:"Preview your prototype, share with your team or export your designs.",side:"left",align:"start"}}],ty=()=>{let e,t,r=(0,b.c)(2),n=(0,w.useRef)(0);return r[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>{if(localStorage.getItem(tv))return;let e=(0,tg.B)({showProgress:!1,overlayOpacity:.4,stagePadding:0,stageRadius:16,disableActiveInteraction:!0,popoverClass:"!rounded-[18px] !shadow-none",popoverOffset:4,showButtons:["next","previous"],steps:tb,onDestroyed:()=>{localStorage.setItem(tv,"true"),n.current===tb.length?k.A.logEvent("[Canvas Tour] completed",{stepIndex:n.current}):k.A.logEvent("[Canvas Tour] closed",{stepIndex:n.current})},onNextClick:()=>{n.current=n.current+1,k.A.logEvent("[Canvas Tour] next clicked",{stepIndex:n.current}),e.moveNext()},onPrevClick:()=>{0!==n.current&&(n.current=n.current-1,k.A.logEvent("[Canvas Tour] previous clicked",{stepIndex:n.current}),e.movePrevious())}}),t=setTimeout(()=>{k.A.logEvent("[Canvas Tour] started"),e.drive()},500);return()=>{clearTimeout(t),e.destroy()}},t=[],r[0]=e,r[1]=t):(e=r[0],t=r[1]),(0,w.useEffect)(e,t),null};var tw=r(15551);function tj(){let e,t,r=(0,b.c)(4),n=(0,y.p)(),{genType:l}=(0,w.useContext)(ez.c).flow;return r[0]!==n||r[1]!==l?(e=()=>{k.A.logEvent("[Chat] page rendered",{chatId:n,genType:l})},t=[n,l],r[0]=n,r[1]=l,r[2]=e,r[3]=t):(e=r[2],t=r[3]),(0,w.useEffect)(e,t),null}function tk(){let e,t,r,n,l,s,o,a,i,c,d,u,m=(0,b.c)(28),{flow:p}=(0,w.useContext)(ez.c),h=p.id,x=(0,N.useRouter)();"mobile"===p.genType&&x.replace("/flow");let{createScreenCentered:f,createScreenContextual:g}=(0,tw.M)(),{readonly:y}=(0,w.useContext)(Q.U),{isModalOpen:j,pendingNextScreen:k,handleConfirm:C,handleCancel:E}=(0,tf.d)(g);if((0,eK.x)(),!h){let e;return m[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,v.jsx)(th.L,{}),m[0]=e):e=m[0],e}return m[1]===Symbol.for("react.memo_cache_sentinel")?(e={width:"100vw",height:"100vh",overflow:"hidden",position:"relative"},t=(0,v.jsx)(tj,{}),r=(0,v.jsx)(ty,{}),m[1]=e,m[2]=t,m[3]=r):(e=m[1],t=m[2],r=m[3]),m[4]!==h?(n=(0,v.jsx)("div",{id:"tour-share",className:"shadow-ui-sm absolute right-1 top-1 z-[40] rounded-2xl bg-white p-2",children:(0,v.jsx)(tc,{flowId:h})}),m[4]=h,m[5]=n):n=m[5],m[6]!==f||m[7]!==h?(l=(0,v.jsx)(eQ,{flowId:h,handleAddChat:f}),m[6]=f,m[7]=h,m[8]=l):l=m[8],m[9]!==h?(s=(0,v.jsx)($,{flowId:h}),m[9]=h,m[10]=s):s=m[10],m[11]===Symbol.for("react.memo_cache_sentinel")?(o={width:"100%"},m[11]=o):o=m[11],m[12]!==y?(a=!y&&(0,v.jsx)(e$.o,{}),m[12]=y,m[13]=a):a=m[13],m[14]===Symbol.for("react.memo_cache_sentinel")?(i=(0,v.jsx)(eq.H,{}),m[14]=i):i=m[14],m[15]!==a?(c=(0,v.jsx)("div",{className:"flex h-screen w-screen",children:(0,v.jsxs)("div",{style:o,className:"relative",children:[a,i]})}),m[15]=a,m[16]=c):c=m[16],m[17]!==E||m[18]!==C||m[19]!==j||m[20]!==k?(d=(0,v.jsx)(ee,{isOpen:j,onClose:E,onConfirm:C,nextScreen:k}),m[17]=E,m[18]=C,m[19]=j,m[20]=k,m[21]=d):d=m[21],m[22]!==d||m[23]!==n||m[24]!==l||m[25]!==s||m[26]!==c?(u=(0,v.jsxs)("div",{style:e,children:[t,r,n,l,s,c,d]}),m[22]=d,m[23]=n,m[24]=l,m[25]=s,m[26]=c,m[27]=u):u=m[27],u}let tN=(0,j.$)(function(e){let t,r,n,l,s,o,a,i,c,d=(0,b.c)(21),{params:u}=e,{id:m}=(0,w.use)(u);d[0]!==m?(t={flowId:m},d[0]=m,d[1]=t):t=d[1];let{data:p}=z.i.getFlow.useQuery(t);d[2]!==m?(r={flowId:m},d[2]=m,d[3]=r):r=d[3],z.i.getFlowScreens.usePrefetchQuery(r);let{maintenanceReadonly:h}=(0,tx.R)();if(!p){let e;return d[4]===Symbol.for("react.memo_cache_sentinel")?(e=(0,v.jsx)(th.L,{}),d[4]=e):e=d[4],e}d[5]!==p.genType||d[6]!==h?(n=()=>"mobile"===p.genType||"web"===p.genType?{readonly:!0,reason:{title:"View-only project",description:"This project uses an older format that can't be edited anymore. You can still open and view it. Contact us if you need to edit or have any questions."}}:h||{readonly:!1},d[5]=p.genType,d[6]=h,d[7]=n):n=d[7];let x=n;return d[8]!==p?(l={flow:p},d[8]=p,d[9]=l):l=d[9],d[10]!==x?(s=x(),d[10]=x,d[11]=s):s=d[11],d[12]===Symbol.for("react.memo_cache_sentinel")?(o=(0,v.jsx)(tk,{}),d[12]=o):o=d[12],d[13]!==p.id?(a=(0,v.jsx)(tw.l,{flowId:p.id,children:o}),d[13]=p.id,d[14]=a):a=d[14],d[15]!==s||d[16]!==a?(i=(0,v.jsx)(Q.U.Provider,{value:s,children:a}),d[15]=s,d[16]=a,d[17]=i):i=d[17],d[18]!==l||d[19]!==i?(c=(0,v.jsx)(ez.c.Provider,{value:l,children:i}),d[18]=l,d[19]=i,d[20]=c):c=d[20],c})}},e=>{e.O(0,[3998,3515,6009,6143,3965,3862,9690,4390,586,1927,7019,5480,95,5781,5298,8907,8643,9331,4611,28,9750,337,467,3336,8682,5459,6862,3295,4065,9172,8722,2e3,865,1355,325,4955,4850,8441,8663,7358],()=>e(e.s=7652)),_N_E=e.O()}]);